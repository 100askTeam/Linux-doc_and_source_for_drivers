if(!window.iamInitialized){if(!Array.prototype.find){Object.defineProperty(Array.prototype,'find',{value:function(predicate){'use strict';if(this==null){throw new TypeError('Array.prototype.find called on null or undefined');}if(typeof predicate!=='function'){throw new TypeError('predicate must be a function');}var list=Object(this);var length=list.length>>>0;var thisArg=arguments[1];for(var i=0;i!==length;i++){if(predicate.call(thisArg,this[i],i,list)){return this[i];}}return undefined;}});}if(!Array.prototype.filter){Array.prototype.filter=function(fun){'use strict';if(this===void 0||this===null){throw new TypeError();}var t=Object(this);var len=t.length>>>0;if(typeof fun!=='function'){throw new TypeError();}var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t)){res.push(val);}}}return res;};}if(!Object.keys){Object.keys=(function(){'use strict';var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='function'&&(typeof obj!=='object'||obj===null)){throw new TypeError('Object.keys called on non-object');}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}}return result;};}());}if(!Object.entries)Object.entries=function(obj){var ownProps=Object.keys(obj),i=ownProps.length,resArray=new Array(i);while(i--)resArray[i]=[ownProps[i],obj[ownProps[i]]];return resArray;}
if(!Array.prototype.forEach){Array.prototype.forEach=function(callback){var T,k;if(this==null){throw new TypeError('this is null or not defined');}var O=Object(this);var len=O.length>>>0;if(typeof callback!=='function'){throw new TypeError(callback+' is not a function');}if(arguments.length>1){T=arguments[1];}k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O);}k++;}};}if(!Object.assign){Object.defineProperty(Object,'assign',{enumerable:false,configurable:true,writable:true,value:function(target,firstSource){'use strict';if(target===undefined||target===null){throw new TypeError('Cannot convert first argument to object');}var to=Object(target);for(var i=1;i<arguments.length;i++){var nextSource=arguments[i];if(nextSource===undefined||nextSource===null){continue;}nextSource=Object(nextSource);var keysArray=Object.keys(Object(nextSource));for(var nextIndex=0,len=keysArray.length;nextIndex<len;nextIndex++){var nextKey=keysArray[nextIndex];var desc=Object.getOwnPropertyDescriptor(nextSource,nextKey);if(desc!==undefined&&desc.enumerable){to[nextKey]=nextSource[nextKey];}}}return to;}});}if(!String.prototype.endsWith){String.prototype.endsWith=function(search,this_len){if(this_len===undefined||this_len>this.length){this_len=this.length;}return this.substring(this_len-search.length,this_len)===search;};}if(!String.prototype.replaceAt){String.prototype.replaceAt=function(index,char){var a=this.split("");a[index]=char;return a.join("");}}if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(typeof start!=='number'){start=0;}if(start+search.length>this.length){return false;}else{return this.indexOf(search,start)!==-1;}};}(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:null};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}window.CustomEvent=CustomEvent;})();}IOL=window.IOL||{};if(!window.iamInitialized){IOL.adv={classname:"IOL.adv",version:"2.6.0",server:"//www.iolam.it",domain:"",origin:window.location.origin,hasFocus:false,pageWidth:document.documentElement.clientWidth||window.innerWidth,url:((document.URL)?document.URL:''),referrer:((document.referrer)?document.referrer:false),referrerLabel:false,topics:[],running:false,onDemandRunning:false,complete:false,mode:'standard',connectionType:"4g",downlink:5,trackingMsg:"",deferredIteration:0,deferredMaxIteration:400,deferredInterval:50,deferredTimer:null,pubAdsCfg:{slot:"default",originalSlot:"default",section:"default",prestitial:false,native:false,inread:false,customCriteria:false,profile:true,prebid:true,lazy:false,gptlazy:false,deferredDivId:true,deferredDisplay:false,deferredRun:false,forceHttps:false,dynamicAds:{enable:false},antiMalware:false,},gdpr:{enable:((typeof __tcfapi==='function')?true:false),timer:false,interval:100,maxIteration:20,consentString:false,tcfv20:{tcData:false,pipeline:{method:'standard',cmpApi:'iab'},rewriteConsentCookie:{enable:false,name:'localconsent-v2',duration:90}}},profile:{enable:true,up:{remoteHandler:"/up",cookie:{name:"up",duration:30},value:{trk:Math.floor((Math.random()*100)+1),up:false,ppid:false,age:false,gender:false,province:false,ext:{seat_keyword:false}},comingFrom:"none",resource:{url:""}},as:{enable:true,cookie:{name:"as",duration:30,refresh:3600000},value:{pid:"",audienceId:[],s:[],t:[]},comingFrom:"none",resource:{url:"//ad.crwdcntrl.net/5/c=6199/pe=y/callback=IOL.adv.tools.asHandlerCallback"}}},videoAds:{"id":false,"reqCounter":0,"status":'ready',"mode":'get',"adUnitPath":false,"adServerUrl":false,"trueview":{"threshold":999999,"param":false},"hb":{"enable":false,"bidders":[],"complete":false,"timedOut":false},"bob":{},"timer":false},track:{enable:true&&(typeof window.performance!=='undefined'&&typeof window.performance.now!=='undefined'),msg:'',remoteHandler:"/trk",percentCustomerBase:5,druidContainer:{},resourceLoadingError:true},test:{enable:false,param:"dctestAdv",cookie:{name:"advTest",duration:1},value:false,paramAdUnitVideo:"iu",adUnitVideo:false,slot:"test"},timer:true&&(typeof window.performance!=='undefined'&&typeof window.performance.now!=='undefined'),debug:{log:false,id:false,console:false,},consoleHandler:"/js/cnsl.js",start:function(){var classFunc=IOL.adv.classname+".start";IOL.adv.tools.timer("IOL.adv",".grandTotal","start");IOL.adv.tools.logger("start function",classFunc);IOL.adv.domain=IOL.adv.tools.getDomain(window.location.host);IOL.adv.hasFocus=window.document.hasFocus();IOL.adv.referrerLabel=IOL.adv.tools.getReferrerLabel(IOL.adv.referrer,'other');IOL.adv.topics=IOL.adv.tools.getMetaTag('keywords',',');if(navigator.connection!==undefined){IOL.adv.connectionType=navigator.connection.effectiveType;IOL.adv.downlink=navigator.connection.downlink;IOL.adv.tools.logger("domain: "+IOL.adv.domain+", focus: "+IOL.adv.hasFocus+", connectionType: "+IOL.adv.connectionType+", downlink: "+IOL.adv.downlink,classFunc);if(IOL.adv.connectionType=='2g'||IOL.adv.connectionType=='slow-2g'){IOL.adv.tools.logger("Disable header bidding in case of slow connection",classFunc);IOL.adv.pubAdsCfg.prebid=false;}}if(!window.pubAdsCfg)window.pubAdsCfg={};IOL.adv.tools.objAssigner(IOL.adv.pubAdsCfg,window.pubAdsCfg);if(IOL.adv.tools.getParameterByName("iam_console")){try{var dbg=JSON.parse(IOL.adv.tools.getParameterByName("iam_console"));IOL.adv.tools.objAssigner(IOL.adv.debug,dbg);IOL.adv.tools.objAssigner(IOL.adv.pubAdsCfg,IOL.adv.debug);}catch(e){IOL.adv.tools.logger("Error parsing debug parameter, please use the following specs: {\"log\":true,\"console\":true,\"lazy\":true,\"prebid\":false}",classFunc,'error');}}if(IOL.adv.pubAdsCfg.deferredRun){IOL.adv.pubAdsCfg.deferredDivId=false;IOL.adv.pubAdsCfg.deferredDisplay=true;}if(IOL.adv.debug.log&&!IOL.adv.debug.id)IOL.adv.debug.id=IOL.adv.tools.randomId();IOL.adv.test.value=(IOL.adv.tools.getParameterByName(IOL.adv.test.param))?IOL.adv.tools.getParameterByName(IOL.adv.test.param):IOL.adv.cookie.get(IOL.adv.test.cookie.name);if(IOL.adv.test.value!==false){switch(IOL.adv.test.value){case"0":case"off":IOL.adv.cookie.erase(IOL.adv.test.cookie.name);IOL.adv.tools.logger("Disable test on this properties with value: "+IOL.adv.test.value,classFunc);break;default:IOL.adv.test.enable=true;IOL.adv.cookie.set(IOL.adv.test.cookie.name,IOL.adv.test.value,IOL.adv.test.cookie.duration);IOL.adv.pubAdsCfg.slot=IOL.adv.test.slot+((IOL.adv.pubAdsCfg.slot!=='default')?"_"+IOL.adv.pubAdsCfg.slot:"");if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]){IOL.adv.test.adUnitVideo=(IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitVideo))?IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitVideo):false;if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo&&IOL.adv.test.adUnitVideo)IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.adUnitPath=IOL.adv.test.adUnitVideo;IOL.adv.tools.logger("Enable test on this properties with value: "+IOL.adv.test.value+", adUnitVideo: "+IOL.adv.test.adUnit,classFunc);}else{IOL.adv.test.enable=false;IOL.adv.pubAdsCfg.slot=IOL.adv.pubAdsCfg.originalSlot;IOL.adv.tools.logger("test slot does not exist, run with provided/default slot: "+IOL.adv.pubAdsCfg.slot,classFunc,"warning");}break;}}IOL.adv.test.enable=IOL.adv.test.enable||(IOL.adv.pubAdsCfg.slot==IOL.adv.test.slot);if(IOL.adv.test.enable)IOL.adv.test.value=(IOL.adv.test.value)?IOL.adv.test.value:"1";if(IOL.adv.pubAdsCfg.prestitial===true){IOL.adv.tools.logger("Prestitial is requested, check frequency cap.",classFunc);if(typeof IOL.adv.settings.ifPrestitial==='function'){if(IOL.adv.settings.ifPrestitial()){IOL.adv.pubAdsCfg.originalSlot=IOL.adv.pubAdsCfg.slot;IOL.adv.pubAdsCfg.slot="prestitial";IOL.adv.tools.logger("Prestitial enabled, override Runtime Slot with \""+IOL.adv.pubAdsCfg.slot+"\"",classFunc);if(IOL.adv.test.enable)IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.adprestitial.adUnitPath=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.adprestitial.adUnitPathTest.replace("%PLACEHOLDER%",IOL.adv.test.value);IOL.adv.tools.logger("prestitial adUnitPath: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.adprestitial.adUnitPath,classFunc);IOL.adv.pubAdsCfg.prebid=false;IOL.adv.pubAdsCfg.lazy=false;}else{IOL.adv.pubAdsCfg.prestitial=false;IOL.adv.tools.logger("Prestitial disable by ifPrestitial",classFunc);}}else{IOL.adv.pubAdsCfg.prestitial=false;IOL.adv.tools.logger("Prestitial disable, IOL.adv.settings.ifPrestitial function in not implemented but is required.",classFunc);}}IOL.adv.tools.logger("Client  pubAdsCfg: "+JSON.stringify(window.pubAdsCfg),classFunc);IOL.adv.tools.logger("Runtime pubAdsCfg: "+JSON.stringify(IOL.adv.pubAdsCfg),classFunc);if(typeof IOL.adv.settings=='undefined'||IOL.adv.settings.error){IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::nameSpaceError::";IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);IOL.adv.tools.logger('nameSpaceError: '+((IOL.adv.trackingMsg)?IOL.adv.trackingMsg:'unknown'),classFunc,'error');return;}if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]){IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::slotDoesNotExist";IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);IOL.adv.tools.logger('requested slot '+IOL.adv.pubAdsCfg.slot+' is not defined in this namespace',classFunc,'error');return;}IOL.adv.tools.logger("Requested Slot: "+IOL.adv.pubAdsCfg.slot,classFunc);window.grumi={cfg:{advs:{},pubIds:{}},key:'4415fe16-b37d-46de-ac5c-69d63c72d5ee'};if(IOL.adv.settings.tcfv20){IOL.adv.tools.logger("Override tcfv20",classFunc);IOL.adv.gdpr.tcfv20=IOL.adv.settings.tcfv20;}IOL.adv.tools.cmpHandler(classFunc,function(){IOL.adv.runCmp();},function(){IOL.adv.run();},IOL.adv.gdpr.timer,true);IOL.adv.tools.logger("end function",classFunc);},runCmp:function(){var classFunc=IOL.adv.classname+".runCmp";switch(IOL.adv.gdpr.tcfv20.pipeline.method){case'demand':IOL.adv.tools.logger("run in demand mode",classFunc);if(IOL.adv.gdpr.tcfv20.pipeline.callback){IOL.adv.tools.logger("run deferred @callback",classFunc);IOL.adv.gdpr.tcfv20.pipeline.callback();}break;case'standard':default:IOL.adv.tools.logger("run in standard mode",classFunc);window.__tcfapi('getTCData',2,function(tcData,success){if(success){IOL.adv.gdpr.tcfv20.tcData=tcData;IOL.adv.gdpr.consentString=((IOL.adv.gdpr.tcfv20.tcData.tcString)?IOL.adv.gdpr.tcfv20.tcData.tcString:false);IOL.adv.tools.logger("getTCData success, tcData: "+JSON.stringify(IOL.adv.gdpr.tcfv20.tcData),classFunc);if(IOL.adv.gdpr.consentString){if(IOL.adv.gdpr.tcfv20.rewriteConsentCookie.enable){IOL.adv.cookie.set(IOL.adv.gdpr.tcfv20.rewriteConsentCookie.name,IOL.adv.gdpr.consentString,IOL.adv.gdpr.tcfv20.rewriteConsentCookie.duration);IOL.adv.tools.logger("getTCData, set or refresh consent cookie: "+IOL.adv.gdpr.tcfv20.rewriteConsentCookie.name,classFunc);}IOL.adv.tools.logger("getTCData, start advertising pipeline",classFunc);IOL.adv.run();}}});window.__tcfapi('addEventListener',2,function(tcData,success){if(success){if(tcData.eventStatus==='tcloaded'||tcData.eventStatus==='useractioncomplete'){IOL.adv.tools.logger("addEventListener eventStatus: "+tcData.eventStatus+" ,success: "+success,classFunc);IOL.adv.gdpr.tcfv20.tcData=tcData;IOL.adv.gdpr.consentString=((IOL.adv.gdpr.tcfv20.tcData.tcString)?IOL.adv.gdpr.tcfv20.tcData.tcString:false);IOL.adv.tools.logger("addEventListener tcData: "+JSON.stringify(IOL.adv.gdpr.tcfv20.tcData),classFunc);if(IOL.adv.gdpr.tcfv20.rewriteConsentCookie.enable&&IOL.adv.gdpr.consentString){IOL.adv.cookie.set(IOL.adv.gdpr.tcfv20.rewriteConsentCookie.name,IOL.adv.gdpr.consentString,IOL.adv.gdpr.tcfv20.rewriteConsentCookie.duration);IOL.adv.tools.logger("getTCData, set or refresh consent cookie: "+IOL.adv.gdpr.tcfv20.rewriteConsentCookie.name,classFunc);}IOL.adv.tools.logger("addEventListener, start advertising pipeline (if is not already running)",classFunc);IOL.adv.run();window.__tcfapi('removeEventListener',2,function(success){IOL.adv.tools.logger("addEventListener removed success: "+success,classFunc);},tcData.listenerId);}else
IOL.adv.tools.logger("addEventListener eventStatus: "+tcData.eventStatus,classFunc);}else{IOL.adv.tools.logger("addEventListener failed, start advertising pipeline anyway",classFunc);IOL.adv.run();}});break;}},run:function(){var classFunc=IOL.adv.classname+".run";if(IOL.adv.running){IOL.adv.tools.logger("iam is already running",classFunc);return;}IOL.adv.tools.logger("start advertising pipeline",classFunc);IOL.adv.running=true;IOL.adv.setProfile();IOL.adv.tools.trkPerf("iamStart",Math.floor(performance.now()));if(IOL.adv.track.enable){IOL.adv.track.msg=IOL.adv.version+"::IOL.adv.run."+((IOL.adv.gdpr.enable)?"tcfv20":"notcf")+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::time.iam.startTime::"+Math.floor(performance.now());IOL.adv.tools.logger(IOL.adv.track.msg,classFunc);IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=debug&msg="+IOL.adv.track.msg);}if(IOL.adv.tools.mEnable("zeotap")){var i=document.createElement("iframe");i.src='https://spl.zeotap.com/?zdid=1396&ctry=ITA&env=mWeb&eventType=map&gdpr='+((IOL.adv.gdpr.consentString)?'1':'0')+'&gdpr_consent='+IOL.adv.gdpr.consentString;i.style='display:none';var t=document.getElementsByTagName('body')[0];if(t)t.appendChild(i);}if(IOL.adv.tools.mEnable("lotameimprove")){var i=document.createElement('img');i.src='https://ad.360yield.com/ux?publisher_dmp_id=12&r=https%3A%2F%2Fsync.crwdcntrl.net%2Fmap%2Fc%3D15017%2Ftp%3DIMPR%2Ftpid%3D%7BPUB_USER_ID%7D';i.style='display: none;';var t=document.getElementsByTagName('body')[0];if(t)t.appendChild(i);}if(IOL.adv.tools.mEnable("pih")){(function(){var purl=window.location.href;var url='//ads.pubmatic.com/AdServer/js/pwt/83172/4188';var profileVersionId='';if(purl.indexOf('pwtv=')>0){var regexp=/pwtv=(.*?)(&|$)/g;var matches=regexp.exec(purl);if(matches.length>=2&&matches[1].length>0){profileVersionId='/'+matches[1];}}var wtads=document.createElement('script');wtads.async=true;wtads.type='text/javascript';wtads.src=url+profileVersionId+'/pwt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(wtads,node);})();}Object.keys(IOL.adv.settings.library).forEach(function(key){IOL.adv.tools.inject(IOL.adv.settings.library[key]);});IOL.adv.deferredTimer=setInterval(function(){IOL.adv.deferredLibLoading(function(){IOL.adv.manager.init(function(){IOL.adv.manager.run()})});},IOL.adv.deferredInterval);IOL.adv.tools.trkGdpr();},setProfile:function(){var classFunc=IOL.adv.classname+".setProfile";IOL.adv.tools.timer(classFunc,"Function","start");IOL.adv.tools.logger("Start function",classFunc);if(IOL.adv.gdpr.enable&&IOL.adv.gdpr.tcfv20.tcData){if(IOL.adv.gdpr.tcfv20.tcData.purpose)if(IOL.adv.gdpr.tcfv20.tcData.purpose.consents)IOL.adv.profile.enable=IOL.adv.pubAdsCfg.profile&&((IOL.adv.gdpr.tcfv20.tcData.purpose.consents)?((IOL.adv.gdpr.tcfv20.tcData.purpose.consents[4])?IOL.adv.gdpr.tcfv20.tcData.purpose.consents[4]:false):false);}else{var profilingCookiePolicy=IOL.adv.cookie.getProfileEnable();IOL.adv.profile.enable=profilingCookiePolicy&&IOL.adv.pubAdsCfg.profile;IOL.adv.tools.logger("user profiling in fallback mode based on cookie, user profiling enabled: "+IOL.adv.profile.enable,classFunc);}IOL.adv.profile.enable=((IOL.adv.settings.enableUserProfiling!==false)?IOL.adv.profile.enable:false);IOL.adv.tools.logger("user profiling enabled: "+IOL.adv.profile.enable,classFunc);IOL.adv.profile.as.enable=((IOL.adv.settings.enableAudience!==false)?true:false);IOL.adv.profile.up.cookie.name=((IOL.adv.settings.userProfilingCookieName)?IOL.adv.settings.userProfilingCookieName:IOL.adv.profile.up.cookie.name);if(IOL.adv.profile.enable)IOL.adv.upHandler();else
IOL.adv.delProfile('light');IOL.adv.track.percentCustomerBase=((IOL.adv.settings.percentCustomerBase)?IOL.adv.settings.percentCustomerBase:IOL.adv.track.percentCustomerBase);if(IOL.adv.track.enable)if(IOL.adv.profile.up.value.trk<=IOL.adv.track.percentCustomerBase){IOL.adv.track.enable=true;}else
IOL.adv.track.enable=false;IOL.adv.tools.logger("tracking enable: "+IOL.adv.track.enable,classFunc);IOL.adv.tools.logger("End function, time elapsed is:  "+IOL.adv.tools.timer(classFunc,"Function","partial"),classFunc);},upHandler:function(){var classFunc=IOL.adv.classname+".upHandler";IOL.adv.tools.timer(classFunc,"Function","start");IOL.adv.tools.logger("Start function",classFunc);var upLocal={value:{trk:Math.floor((Math.random()*100)+1),up:"",ppid:{},ts:"0"}};var cookieValue=IOL.adv.cookie.get(IOL.adv.profile.up.cookie.name);if(cookieValue){try{upLocal.value=JSON.parse(unescape(cookieValue));if(upLocal.value.ppid==undefined)upLocal.value.ppid={};if(upLocal.value.ext==undefined)upLocal.value.ext={seat_keyword:false};}catch(e){IOL.adv.tools.logger("Error parsing cookie "+IOL.adv.profile.up.cookie.name+", err: "+e.message,classFunc);}IOL.adv.profile.up.value=Object.assign({},upLocal.value);IOL.adv.profile.up.comingFrom="Cookie "+IOL.adv.profile.up.cookie.name;IOL.adv.profile.up.duration=IOL.adv.tools.timer(classFunc,"Function","partial");}if(IOL.adv.profile.up.value.up){var aUp=IOL.adv.profile.up.value.up.split("-");if(aUp.length>0){IOL.adv.profile.up.value.age=(aUp[0])?aUp[0]:'0';IOL.adv.profile.up.value.gender=(aUp[1])?aUp[1]:'0';IOL.adv.profile.up.value.province=(aUp)?aUp[2]:'0';}}IOL.adv.profile.up.resource.url=IOL.adv.server+IOL.adv.profile.up.remoteHandler;IOL.adv.tools.logger("Handle the local user profile calling the remote host: "+IOL.adv.profile.up.resource.url,classFunc);IOL.adv.tools.timer("",IOL.adv.profile.up.resource.url,"start");IOL.adv.tools.remoteCall(IOL.adv.profile.up.resource.url,'d='+IOL.adv.domain+'&a=get&cn='+IOL.adv.profile.up.cookie.name+'&v={"ts":'+upLocal.value.ts+'}',true,function(res){IOL.adv.tools.logger("User Profile returned from remote host: "+res,classFunc);var resObj={};try{resObj=JSON.parse(unescape(res));}catch(e){resObj.cb="";}if(resObj.cb=='set'){IOL.adv.cookie.set(IOL.adv.profile.up.cookie.name,JSON.stringify(resObj.v),IOL.adv.profile.up.cookie.duration);IOL.adv.profile.up.comingFrom="remoteCall";IOL.adv.tools.logger("User profile has been written or refreshed on this properties with value:"+res,classFunc);}else
IOL.adv.tools.logger("User profile, nothing to write or refresh",classFunc);IOL.adv.profile.up.duration=IOL.adv.tools.timer("",IOL.adv.profile.up.resource.url,"partial");});if(IOL.adv.profile.as.enable){IOL.adv.tools.logger("Send message asHandler",classFunc);window.postMessage({from:'iam',action:'asStart'},IOL.adv.origin);}IOL.adv.tools.logger("User Profile final object value: "+JSON.stringify(IOL.adv.profile.up.value)+", comingFrom: "+IOL.adv.profile.up.comingFrom,classFunc);IOL.adv.tools.logger("End function, time elapsed is:  "+IOL.adv.tools.timer(classFunc,"Function","partial"),classFunc);},delProfile:function(mode){var classFunc=IOL.adv.classname+".delProfile";IOL.adv.tools.timer(classFunc,"Function","start");IOL.adv.tools.logger("Start function",classFunc);IOL.adv.cookie.erase(IOL.adv.profile.up.cookie.name);IOL.adv.cookie.erase(IOL.adv.profile.as.cookie.name);if(mode=='full'){IOL.adv.tools.logger("Start removing cookie also for www.iolam.it calling handler:"+IOL.adv.server+IOL.adv.profile.up.remoteHandler,classFunc);IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.profile.up.remoteHandler,'d='+IOL.adv.domain+'&a=del&cn='+IOL.adv.profile.up.cookie.name,true);IOL.adv.tools.logger("End removing cookie also for www.iolam.it",classFunc);}IOL.adv.tools.logger("End function, time elapsed is:  "+IOL.adv.tools.timer(classFunc,"Function","partial"),classFunc);},getConsentString:function(){var classFunc=IOL.adv.classname+".getConsentString";IOL.adv.tools.logger("return consentString: "+IOL.adv.gdpr.consentString,classFunc);return IOL.adv.gdpr.consentString;},isUserProfileEnable:function(){var classFunc=IOL.adv.classname+".isUserProfileEnable";IOL.adv.tools.logger("return isUserProfileEnable: "+IOL.adv.profile.enable,classFunc);return IOL.adv.profile.enable;},getProfile:function(what){var classFunc=IOL.adv.classname+".getProfile";var ret={};IOL.adv.tools.logger("Start function",classFunc);what=(what)?what:"";switch(what){case"age":ret.age=(IOL.adv.profile.up.value.age!==false)?IOL.adv.profile.up.value.age:"0";break;case"gender":ret.gender=((IOL.adv.profile.up.value.gender!==false)?IOL.adv.profile.up.value.gender:"0");break;case"province":ret.province=(IOL.adv.profile.up.value.province!==false)?IOL.adv.profile.up.value.province:"0";break;case"consentData":var consentData=IOL.adv.getConsentString();ret.consentData=(consentData!=="")?consentData:false;break;case"audience":ret.audience=(IOL.adv.profile.as.value!==false)?IOL.adv.profile.as.value:false;break;case"all":default:ret.age=(IOL.adv.profile.up.value.age!==false)?IOL.adv.profile.up.value.age:"0";ret.gender=((IOL.adv.profile.up.value.gender!==false)?IOL.adv.profile.up.value.gender:"0");ret.province=(IOL.adv.profile.up.value.province!==false)?IOL.adv.profile.up.value.province:"0";var consentData=IOL.adv.getConsentString();ret.consentData=(consentData!=="")?consentData:false;ret.audience=(IOL.adv.profile.as.value!==false)?IOL.adv.profile.as.value:false;break;}IOL.adv.tools.logger("getProfile parameter: "+what+", return: "+JSON.stringify(ret),classFunc);IOL.adv.tools.logger("End function",classFunc);return ret;},hasConsent:function(){var classFunc=IOL.adv.classname+".hasConsent";var r=true;if(IOL.adv.gdpr.enable)r=((IOL.adv.gdpr.consentString)?true:false);IOL.adv.tools.logger("hasConsent: "+r,classFunc);return r;},deferredLibLoading:function(fn){var classFunc=IOL.adv.classname+".deferredLibLoading";var status=true;IOL.adv.tools.logger("deferredLibLoading ::deferredMaxIteration:"+IOL.adv.deferredMaxIteration+", deferredIteration: "+IOL.adv.deferredIteration+", deferredInterval (ms.):"+IOL.adv.deferredInterval,classFunc);if(IOL.adv.deferredIteration<=IOL.adv.deferredMaxIteration){Object.keys(IOL.adv.settings.library).forEach(function(key){IOL.adv.tools.logger(key+" live: "+IOL.adv.settings.library[key].live+", enable: "+IOL.adv.settings.library[key].enable+((!IOL.adv.settings.library[key].enable)?", library not in use":""),classFunc);status=status&&(IOL.adv.settings.library[key].live||!IOL.adv.settings.library[key].enable);});if(status){IOL.adv.tools.logger("status true:: deferredMaxIteration:"+IOL.adv.deferredMaxIteration+" deferredIteration: "+IOL.adv.deferredIteration,classFunc);clearInterval(IOL.adv.deferredTimer);fn();}else{IOL.adv.deferredIteration++;IOL.adv.tools.logger("status false, retry:: deferredMaxIteration:"+IOL.adv.deferredMaxIteration+" deferredIteration: "+IOL.adv.deferredIteration,classFunc);}}else{clearInterval(IOL.adv.deferredTimer);Object.keys(IOL.adv.settings.library).forEach(function(key){if(IOL.adv.settings.library[key].mandatory&&IOL.adv.settings.library[key].live){IOL.adv.tools.logger("iteration finished. The mandatory lib with key "+key+" returning with status: "+IOL.adv.settings.library[key].live,classFunc);status=true;}if(status){IOL.adv.tools.logger("iteration finished, start with rendering",classFunc);fn();}});IOL.adv.tools.logger("status false, failed:: deferredMaxIteration:"+IOL.adv.deferredMaxIteration+" deferredIteration: "+IOL.adv.deferredIteration,classFunc);}},showConsole:function(fn){if(document.getElementById("3eRbq4M8vffvBuyT")){document.getElementById("3eRbq4M8vffvBuyT").remove();}IOL.adv.tools.loadJs(IOL.adv.server+IOL.adv.consoleHandler);},refreshSlot:function(id,callback,mediaType){var classFunc=IOL.adv.classname+".refreshSlot";var interval=50;var i=setInterval(function(){if(IOL.adv.complete){IOL.adv.tools.logger("refreshSlot requested and IOL.adv.complete is true, run refreshSlotIsReady",classFunc);clearInterval(i);IOL.adv.refreshSlotIsReady(id,callback,mediaType);}else
IOL.adv.tools.logger("refreshSlot requested but IOL.adv.complete is false, please wait...",classFunc);},interval);},refreshSlotIsReady:function(id,callback,mediaType){var classFunc=IOL.adv.classname+".refreshSlotIsReady";IOL.adv.tools.logger("Start function",classFunc);var mediaType=(mediaType)?mediaType:'display';if(mediaType=='display')IOL.adv.mode='refresh';if(IOL.adv.pubAdsCfg.deferredDisplay)IOL.adv.pubAdsCfg.deferredDisplay=false;IOL.adv.manager.refreshSlotsContainer={requested:[],valid:[],slots:[],ads:{},headerBidding:{prebidjs:{adUnits:[]}}};IOL.adv.manager.videoAds=false;IOL.adv.manager.videoOnly=false;if(id){IOL.adv.manager.refreshSlotsContainer.requested=id.split(',').filter(function(e){if(e)return e;});}else
Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(key){IOL.adv.manager.refreshSlotsContainer.requested.push(key);});IOL.adv.manager.refreshSlotsContainer.valid=IOL.adv.manager.refreshSlotsContainer.requested.filter(function(key){if(!IOL.adv.manager.slotsContainer[key]){return false;}var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[key];var refresh=true;if(ad.refresh){if((Date.now()-ad.refresh.ts)>ad.refresh.gap){ad.refresh.ts=Date.now();}else{refresh=false;IOL.adv.tools.logger("Refresh disable for "+key+", refresh gap is not reached yet",classFunc);}}return ad.mediaType==mediaType&&refresh;});if(mediaType=='video'&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo)IOL.adv.manager.refreshSlotsContainer.valid.push('advideo');IOL.adv.tools.logger("Requested slots: "+IOL.adv.manager.refreshSlotsContainer.requested.toString()+". Valid slots to refresh: "+IOL.adv.manager.refreshSlotsContainer.valid.toString(),classFunc);IOL.adv.manager.refreshSlotsContainer.valid.forEach(function(key){if(IOL.adv.manager.slotsContainer[key]){IOL.adv.manager.refreshSlotsContainer.slots.push(IOL.adv.manager.slotsContainer[key]);}});Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(key){if(IOL.adv.manager.refreshSlotsContainer.valid.indexOf(key)>=0)IOL.adv.manager.refreshSlotsContainer.ads[key]=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[key];});if(typeof IOL.adv.settings.prebidjs!=='undefined')Object.keys(IOL.adv.manager.refreshSlotsContainer.ads).forEach(function(key){var ad=IOL.adv.manager.refreshSlotsContainer.ads[key];IOL.adv.settings.prebidjs.adUnits.filter(function(e){if(e.code==this.code){IOL.adv.tools.logger("prebidjs.adUnits.filter e.code found: "+e.code,classFunc);IOL.adv.manager.refreshSlotsContainer.headerBidding.prebidjs.adUnits.push(e);return true;}},{code:ad.divId});});IOL.adv.tools.logger("Start headerBidding.init",classFunc);IOL.adv.headerBidding.init(IOL.adv.manager.refreshSlotsContainer.ads,IOL.adv.manager.refreshSlotsContainer.headerBidding.prebidjs.adUnits);if(IOL.adv.headerBidding.enable){IOL.adv.tools.logger("headerBidding is enable, start headerBidding refresh, callback: "+callback,classFunc);IOL.adv.headerBidding.run(callback);}else{if(IOL.adv.manager.refreshSlotsContainer.slots.length>0){IOL.adv.tools.logger("Refresh slots using standard mode",classFunc);IOL.adv.tools.displayAds({slotContainer:IOL.adv.manager.refreshSlotsContainer.slots,mode:"refresh-slots"});try{if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete. HeaderBidding is disable",classFunc);IamCallbackOnComplete();}}catch(e){}}if(callback){callback();IOL.adv.tools.logger("Run callback "+callback,classFunc);}}IOL.adv.tools.logger("End function.",classFunc);},createAds:function(id,divId){var classFunc=IOL.adv.classname+".createAds";var interval=100;var callback=(callback)?callback:false;if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic){IOL.adv.tools.logger("dynamic slot is non configured for namespace: "+IOL.adv.settings.ns,classFunc);return;}if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic[id]){IOL.adv.tools.logger(id+" is not a defined ads dynamic slot",classFunc);return;}var divIds=(typeof divId=='string')?Array(divId):divId;divIds.forEach(function(divId){var adId=id+'_'+divId;if(IOL.adv.manager.slotsContainer[adId]){IOL.adv.tools.logger(adId+" has been already created",classFunc);if(callback){IOL.adv.tools.logger("A callback has been requested, run: "+callback,classFunc);callback();}return;}var adSkeleton=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic[id];var i=setInterval(function(){if(IOL.adv.complete&&!IOL.adv.onDemandRunning){IOL.adv.tools.logger("advertising pipeline complete: "+IOL.adv.complete,classFunc);clearInterval(i);IOL.adv.onDemandRunning=true;var onDemandSlot="on-demand-ads";if(IOL.adv.test.enable)onDemandSlot="test_".concat(onDemandSlot);IOL.adv.pubAdsCfg.slot=onDemandSlot;IOL.adv.tools.logger("Apply new slot: "+IOL.adv.pubAdsCfg.slot,classFunc);IOL.adv.pubAdsCfg.deferredDivId=false;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]={};IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]={ads:{}};IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId]={};IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].divId=divId;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].adUnitPath=adSkeleton.adUnitPath;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].size=adSkeleton.size;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].bidAmazon=adSkeleton.bidAmazon;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].divIdReady=true;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].mediaType='display';IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].sizeIsCompliant=true;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].forceSafeFrame=adSkeleton.forceSafeFrame;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].fnBefore=adSkeleton.fnBefore;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].fnAfter=adSkeleton.fnAfter;IOL.adv.tools.logger("Create ads on demand with id: "+adId+", divId: "+divId,classFunc);IOL.adv.manager.originalSlotsContainer=Object.assign({},IOL.adv.manager.slotsContainer);IOL.adv.manager.slotsContainer=[];IOL.adv.tools.logger("originalSlotsContainer: "+IOL.adv.manager.originalSlotsContainer,classFunc);IOL.adv.headerBidding.displayAfterSlotSwitch=true;if(IOL.adv.settings.prebidjs.adUnits){IOL.adv.settings.prebidjs.originalAdUnits=IOL.adv.settings.prebidjs.adUnits;IOL.adv.settings.prebidjs.adUnits=[];}if(IOL.adv.settings.prebidjs.onDemandAdUnits){if(IOL.adv.settings.prebidjs.onDemandAdUnits[id]){IOL.adv.tools.logger("prebid dynamic code: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].divId,classFunc);IOL.adv.settings.prebidjs.onDemandAdUnits[id].code=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[adId].divId;IOL.adv.settings.prebidjs.adUnits=[IOL.adv.settings.prebidjs.onDemandAdUnits[id]];}}IOL.adv.manager.init(function(){IOL.adv.manager.run()});googletag.pubads().addEventListener('slotRenderEnded',function(event){if(event.slot.getSlotElementId()==divId){IOL.adv.tools.logger("slotRenderEnded for "+divId+" triggered.",classFunc);IOL.adv.tools.logger("Revert slot and prebid config, extend IOL.adv.manager.slotsContainer with on demand slot",classFunc);IOL.adv.pubAdsCfg.slot=IOL.adv.pubAdsCfg.originalSlot;if(IOL.adv.settings.prebidjs.originalAdUnits)IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.originalAdUnits;IOL.adv.manager.slotsContainer=IOL.adv.tools.extend(IOL.adv.manager.slotsContainer,IOL.adv.manager.originalSlotsContainer);IOL.adv.onDemandRunning=false;}});}else
IOL.adv.tools.logger("advertising pipeline not completed...",classFunc);},interval);});},displaySlot:function(id,callback){var classFunc=IOL.adv.classname+".displaySlot";var slotsContainer={requested:[],slots:[],};if(IOL.adv.pubAdsCfg.deferredDisplay)IOL.adv.pubAdsCfg.deferredDisplay=false;if(id){slotsContainer.requested=id.split(',').filter(function(e){if(e)return e;});}else
Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(key){slotsContainer.requested.push(key);});IOL.adv.tools.logger("Requested slots : "+slotsContainer.requested.toString(),classFunc);slotsContainer.requested.forEach(function(key){if(IOL.adv.manager.slotsContainer[key]){slotsContainer.slots.push(IOL.adv.manager.slotsContainer[key]);IOL.adv.tools.logger(key+" is a valid slot",classFunc);}else
IOL.adv.tools.logger(key+" is not a valid slot",classFunc);});if(IOL.adv.headerBidding.enable)IOL.adv.tools.displayAds({slotContainer:slotsContainer.slots,mode:"refresh-slots"});else
IOL.adv.tools.displayAds({slotId:IOL.adv.manager.lastSlotIdReady,mode:"display-single"});if(callback){IOL.adv.tools.logger("Run callback "+callback,classFunc);callback();}},destroySlot:function(s){var classFunc=IOL.adv.classname+".destroySlot";IOL.adv.tools.logger("Start function",classFunc);IOL.adv.tools.logger("destroySlot request: "+s,classFunc);if(s){var aSlots=s.split(',');aSlots.forEach(function(v){if(IOL.adv.manager.slotsContainer[v]){IOL.adv.tools.logger("start destroySlot for slot: "+v,classFunc);googletag.destroySlots([IOL.adv.manager.slotsContainer[v]]);delete IOL.adv.manager.slotsContainer[v];}else
IOL.adv.tools.logger("slot "+v+" does not exist",classFunc);});}else{IOL.adv.tools.logger("destroySlot for all slots",classFunc);googletag.destroySlots();}IOL.adv.tools.logger("End function",classFunc);},clearSlot:function(s){var classFunc=IOL.adv.classname+".clearSlot";IOL.adv.tools.logger("Start function",classFunc);IOL.adv.tools.logger("clearSlot request: "+s,classFunc);if(s){var aSlots=s.split(',');aSlots.forEach(function(v){if(IOL.adv.manager.slotsContainer[v]){IOL.adv.tools.logger("start clear for slot: "+v,classFunc);googletag.pubads().clear([IOL.adv.manager.slotsContainer[v]]);}else
IOL.adv.tools.logger("slot "+v+" does not exist",classFunc);});}else{IOL.adv.tools.logger("destroySlot for all slots",classFunc);googletag.pubads().clear();}IOL.adv.tools.logger("End function",classFunc);},getAdUnitPath:function(id,provider){var classFunc=IOL.adv.classname+".getAdUnitPath";var r=false;provider=(provider)?provider.toLowerCase():"";try{if(id)if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id]){r=(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPathOverride&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPathOverride[provider])?IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPathOverride[provider]:IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPath;if(IOL.adv.pubAdsCfg.section&&IOL.adv.settings.sectionMap)r=(IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section])?r.replace("%SECTION%",IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section]):r.replace("%SECTION%",IOL.adv.settings.sectionMap["default"]);if(typeof _ABTestingTrack!=="undefined"&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].mediaType=='display')r+="/test"+_ABTestingTrack.toUpperCase();if(IOL.adv.test.enable)r=r.replace("%PLACEHOLDER%",IOL.adv.test.value);}}catch(e){}IOL.adv.tools.logger("adUnitPath for ad: "+id+", provider: "+provider+" is: "+r,classFunc);return r;},setAdUnitPath:function(id,value){var classFunc=IOL.adv.classname+".setAdUnitPath";try{if(id&&value)if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id])IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPath=value;}catch(e){return false;}IOL.adv.tools.logger("adUnitPath for ad: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPath,classFunc);return true;},setAdUnitContent:function(id,o){var classFunc=IOL.adv.classname+".setAdUnitContent";IOL.adv.tools.logger("set content for "+id+": "+o,classFunc);try{if(id&&o){if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id]){IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].content=o;return true;}else{IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].content=false;return false;}}}catch(e){return false;}},setAdSliderContent:function(o){var classFunc=IOL.adv.classname+".setAdSliderContent";IOL.adv.tools.logger("try to set adslider content: "+JSON.stringify(o),classFunc);try{if(o&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer){o.adunit=o.adunit.split('/').pop();IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.content.push(o);IOL.adv.tools.logger("adslider content set",classFunc);return true;}}catch(e){return false;}},setUrl:function(u){var classFunc=IOL.adv.classname+".setUrl";IOL.adv.url=u;IOL.adv.tools.logger("IOL.adv.url: "+IOL.adv.url,classFunc);},setVideoAdsTrueViewThreshold:function(v){var classFunc=IOL.adv.classname+".setVideoAdsTrueViewThreshold";if(v)IOL.adv.videoAds.trueview.threshold=v;IOL.adv.tools.logger("trueview.threshold: "+IOL.adv.videoAds.trueview.threshold,classFunc);},getAdUnitContent:function(id){var classFunc=IOL.adv.classname+".getAdUnitContent";var r=false;try{if(id)if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].content)r=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].content;}catch(e){}IOL.adv.tools.logger("get content for "+id+": "+r,classFunc);return r;},getVideoAds:function(provider,callback,options){var classFunc=IOL.adv.classname+".getVideoAds";IOL.adv.videoAds.running=false;if(IOL.adv.videoAds.reqCounter==0){IOL.adv.tools.cmpHandler(classFunc,function(){window.__tcfapi('addEventListener',2,function(tcData,success){if(success){if(tcData.eventStatus==='tcloaded'||tcData.eventStatus==='useractioncomplete'){IOL.adv.tools.logger("addEventListener eventStatus: "+tcData.eventStatus+" ,success: "+success,classFunc);IOL.adv.gdpr.tcfv20.tcData=tcData;IOL.adv.gdpr.consentString=((IOL.adv.gdpr.tcfv20.tcData.tcString)?IOL.adv.gdpr.tcfv20.tcData.tcString:false);IOL.adv.tools.logger("addEventListener tcData: "+JSON.stringify(IOL.adv.gdpr.tcfv20.tcData),classFunc);IOL.adv.tools.logger("addEventListener, runGetVideoAds start",classFunc);IOL.adv.runGetVideoAds(provider,callback,options);window.__tcfapi('removeEventListener',2,function(success){IOL.adv.tools.logger("addEventListener removed success: "+success,classFunc);},tcData.listenerId);}else
IOL.adv.tools.logger("addEventListener eventStatus: "+tcData.eventStatus,classFunc);}else{IOL.adv.tools.logger("addEventListener failed",classFunc);IOL.adv.tools.logger("addEventListener, runGetVideoAds start anyway",classFunc);IOL.adv.runGetVideoAds(provider,callback,options);}});},function(){IOL.adv.runGetVideoAds(provider,callback,options);},IOL.adv.videoAds.timer,true);}else{IOL.adv.tools.logger("runGetVideoAds start",classFunc);IOL.adv.runGetVideoAds(provider,callback,options);}},runGetVideoAds:function(provider,callback,options){var classFunc=IOL.adv.classname+".runGetVideoAds";if(IOL.adv.videoAds.running){IOL.adv.tools.logger("runGetVideoAds is already running",classFunc);return;}IOL.adv.videoAds.running=true;var interval=50;var id="advideo";var provider=(provider)?provider:"";var options=(options)?options:false;IOL.adv.videoAds.reqCounter++;if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo){IOL.adv.tools.logger("advideo slot is not defined",classFunc);IOL.adv.videoAds.status='error';if(callback){IOL.adv.tools.logger("Requested callback "+callback,classFunc);callback(IOL.adv.videoAds);return;}else
return IOL.adv.videoAds;}else
var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo;if(ad.maxRequest)if(IOL.adv.videoAds.reqCounter>ad.maxRequest.value){if(ad.maxRequest.callback){IOL.adv.tools.logger("max requests exceeded, run: "+ad.maxRequest.callback,classFunc);ad.maxRequest.callback();return;}}if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.divIdReady)IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.divIdReady=true;switch(IOL.adv.videoAds.reqCounter){case 1:IOL.adv.videoAds.mode='standard';break;default:IOL.adv.videoAds.mode='refresh';IOL.adv.refreshSlot(id,false,'video');break;}var i=setInterval(function(){if(IOL.adv.headerBidding.requestManager.adServerRequestSent||!IOL.adv.headerBidding.enable){IOL.adv.tools.logger("HeaderBidding "+((!IOL.adv.headerBidding.enable)?"disable":"done"),classFunc);clearInterval(i);IOL.adv.createVideoAds(provider,callback,options,ad);if(typeof IamCallbackVideoAdsOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackVideoAdsOnComplete in getVideoAds",classFunc);IamCallbackVideoAdsOnComplete();}}else
IOL.adv.tools.logger("HeaderBidding is still running...",classFunc);},interval);},createVideoAds:function(provider,callback,options,ad){var classFunc=IOL.adv.classname+".createVideoAds";var prefixAdServerUrl='https://pubads.g.doubleclick.net/gampad/ads?';IOL.adv.videoAds.id=IOL.adv.tools.randomId();IOL.adv.videoAds.status='ready';IOL.adv.videoAds.adServerUrl=false;IOL.adv.videoAds.hb={'enable':false,'bidders':[],'complete':false,'timedOut':false};if(typeof IOL.adv.settings.overrideProvider=='function'){overrideProvider=IOL.adv.settings.overrideProvider();if(overrideProvider){provider=overrideProvider;IOL.adv.tools.logger("Provider overrided with: "+overrideProvider,classFunc);}}var up=IOL.adv.getProfile();IOL.adv.videoAds.trueview.param=((IOL.adv.videoAds.reqCounter<=IOL.adv.videoAds.trueview.threshold)?'&trueview=yes':'&trueview=no');if(options&&ad.optionalFunction){if(ad.optionalFunction['function']){if(ad.optionalFunction['function'].f){IOL.adv.tools.logger("Run optional function: "+ad.optionalFunction['function'].f,classFunc);ad.optionalFunction['function'].f(ad,options);}}else
IOL.adv.tools.logger("Optional function not defined",classFunc);}IOL.adv.videoAds.adUnitPath=IOL.adv.getAdUnitPath('advideo',provider);IOL.adv.tools.logger("Requested provider: "+provider+", adUnitPath: "+IOL.adv.videoAds.adUnitPath,classFunc);var bs=false;if(IOL.adv.pubAdsCfg.customCriteria)if(IOL.adv.pubAdsCfg.customCriteria.adv_bs)bs=IOL.adv.pubAdsCfg.customCriteria.adv_bs.replace(/\|/g,",");IOL.adv.videoAds.adServerUrl=prefixAdServerUrl+'sz=640x480&ciu_szs=&unviewed_position_start=1&gdfp_req=1&impl=s&env=vp&output=vast'+'&iu='+encodeURIComponent(IOL.adv.videoAds.adUnitPath)+'&url=[referrer_url]&correlator=[timestamp]'+'&description_url='+encodeURIComponent(IOL.adv.url)+'&npa='+((IOL.adv.profile.enable)?'0':'1')+'&cust_params='+encodeURIComponent('adv_sso1='+up.age+'&adv_sso2='+up.gender)+encodeURIComponent((up.audience.audienceId.length>0)?'&laud='+up.audience.audienceId.join(','):'')+encodeURIComponent((up.audience.s.length>0)?'&1plusx='+up.audience.s.join(','):'')+encodeURIComponent((up.audience.t.length>0)?'&ctx1plusx='+up.audience.t.join(','):'')+((IOL.adv.videoAds.trueview.param)?encodeURIComponent(IOL.adv.videoAds.trueview.param):'')+((IOL.adv.topics)?encodeURIComponent('&adv_topics='+IOL.adv.topics.join(',')):'')+((bs)?encodeURIComponent('&adv_bs='+bs):'')+((IOL.adv.referrerLabel)?encodeURIComponent('&adv_referrer='+IOL.adv.referrerLabel):'')+((IOL.adv.pubAdsCfg.native)?encodeURIComponent("&native="+IOL.adv.pubAdsCfg.native):'')+encodeURIComponent('&npa='+((IOL.adv.profile.enable)?'0':'1'))+((up.consentData)?encodeURIComponent('&gdpr=1&gdpr_consent='+up.consentData):'')+IOL.adv.headerBidding.getAmazonVideoBid()+((ad.adServerUrlAppendCustomParams)?encodeURIComponent(ad.adServerUrlAppendCustomParams):'');if(ad.adServerUrlAppendParams)IOL.adv.videoAds.adServerUrl+=ad.adServerUrlAppendParams;if(IOL.adv.headerBidding.prebidjs.enable){var videoAdUnit=IOL.adv.settings.prebidjs.adUnits.find(IOL.adv.headerBidding.findAdunitByMediaType,{'mediaType':'video'});if(videoAdUnit){IOL.adv.tools.logger("Add pbjs bids on video adServerUrl",classFunc);IOL.adv.videoAds.adServerUrl=pbjs.adServers.dfp.buildVideoUrl({adUnit:videoAdUnit,url:IOL.adv.videoAds.adServerUrl,output:'vast'});IOL.adv.tools.logger("Final pbjs video url: "+IOL.adv.videoAds.adServerUrl,classFunc);}}IOL.adv.videoAds.hb.enable=IOL.adv.headerBidding.enable;IOL.adv.videoAds.hb.bidders=(IOL.adv.headerBidding.enable)?IOL.adv.headerBidding.bidders:[];IOL.adv.videoAds.hb.complete=IOL.adv.headerBidding.requestManager.adServerRequestSent;IOL.adv.videoAds.hb.timedOut=IOL.adv.headerBidding.requestManager.timedOut;IOL.adv.videoAds.status='complete';IOL.adv.tools.logger("Video Ads: "+JSON.stringify(IOL.adv.videoAds),classFunc);if(callback){IOL.adv.tools.logger("Requested callback "+callback,classFunc);callback(IOL.adv.videoAds);}return;},getVideoAdServerUrl:function(){return IOL.adv.videoAds.adServerUrl;}}}if(!window.iamInitialized){IOL.adv.tools={classname:"IOL.adv.tools",timerContainer:[],logger:function(msg,cFunc,lvl){if(!IOL.adv.debug.log)return;var e="IAM::"+IOL.adv.version+((IOL.adv.settings.ns)?"::"+IOL.adv.settings.ns:"")+"::"+IOL.adv.debug.id;var lvl=(lvl)?lvl:"info";var m=new Date();var d=m.getUTCFullYear()+"/"+("0"+(m.getUTCMonth()+1)).slice(-2)+"/"+("0"+m.getUTCDate()).slice(-2)+" "+("0"+m.getUTCHours()).slice(-2)+":"+("0"+m.getUTCMinutes()).slice(-2)+":"+("0"+m.getUTCSeconds()).slice(-2)+"."+this.digPadding((m.getUTCMilliseconds()),3);switch(lvl){case"error":console.error("%c"+e+"%c :: ERROR :: "+d+" :: "+cFunc+" :: "+msg,"display: inline-block; color: #fff; background: red; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:white; color: #000; font-size: x-small");break;case"warning":console.warn("%c"+e+"%c :: INFO :: "+d+" :: "+cFunc+" :: "+msg,"display: inline-block; color: #fff; background: #3b88c3; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:#fff; font-size: x-small");break;case"info":default:console.info("%c"+e+"%c :: INFO :: "+d+" :: "+cFunc+" :: "+msg,"display: inline-block; color: #fff; background: #3b88c3; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:#fff; font-size: x-small");break;}},timer:function(classFunc,tag,action){if(!IOL.adv.timer)return;var label=classFunc+"."+tag;if(action=="start"||action=="stop")IOL.adv.tools.timerContainer[label+action]=performance.now();if(action=="partial"){var el=Math.floor(performance.now()-IOL.adv.tools.timerContainer[label+"start"]);IOL.adv.tools.timerContainer[label+action]=el;return el;}if(action=="elapsed")return Math.floor(performance.now());},loadJs:function(f,handleOnError,handleOnLoad,id){var classFunc=IOL.adv.tools.classname+".loadJs";var head=document.head||document.documentElement.childNodes[0];var e=document.createElement('script');e.async=true;e.type='text/javascript';if(id)e.id=id;if(handleOnError)e.onerror=handleOnError;if(handleOnLoad)e.onload=handleOnLoad;var useSSL='https:'==document.location.protocol;e.src=((useSSL||IOL.adv.pubAdsCfg.forceHttps)?'https:':'http:')+f;head.appendChild(e);},documentReady:function(fn){if(document.readyState!='loading'){fn();}else if(document.addEventListener){document.addEventListener('DOMContentLoaded',fn);}else{document.attachEvent('onreadystatechange',function(){if(document.readyState!='loading')fn();});}},divIdsReady:function(ads,aRes){var classFunc=IOL.adv.tools.classname+".divIdsReady";var aRes=(aRes)?aRes:[];var ready=true;Object.keys(ads).forEach(function(id){var ad=ads[id];var optional=(ad.optional===true)?true:false;if(!optional&&ad.divId!==undefined){ad.divIdReady=IOL.adv.tools.divIdReady(ad);ready=ready&&ad.divIdReady;if(ready)if(!aRes.includes(ad.divId))aRes.push(ad.divId);IOL.adv.tools.logger("divId:"+ad.divId+", Optional: "+ad.optional+", Ready: "+ad.divIdReady,classFunc);}else{IOL.adv.tools.logger("divId:"+ad.divId+", Optional: "+ad.optional+", Ready: check is disable for optional ads container",classFunc);}});return ready;},divIdReady:function(ad,getEl){var classFunc=IOL.adv.tools.classname+".divIdReady";var getEl=(getEl)?getEl:false;var ready=false;if(ad.divId){if(typeof ad.divId==='string'){if(getEl)ready=document.getElementById(ad.divId);else
ready=document.getElementById(ad.divId)!==null;}else{var nL=document.querySelectorAll(ad.divId.regex);ready=(nL.length>0)?true:false;}IOL.adv.tools.logger("divId:"+ad.divId+" ready: "+ready,classFunc);}return ready;},divIdSwap:function(width,ads,id){var classFunc=IOL.adv.tools.classname+".divIdSwap";if(width>=ads.divIdSwap.minW&&width<ads.divIdSwap.maxW){IOL.adv.tools.logger(id+" :: start swap ads container",classFunc);if(IOL.adv.settings.prebidjs)if(IOL.adv.settings.prebidjs.adUnits)IOL.adv.settings.prebidjs.adUnits.find(IOL.adv.headerBidding.replaceAdunitByCode,{code:ads.divId,newcode:ads.divIdSwap.divId});IOL.adv.tools.logger(id+" :: override "+ads.divId+" with "+ads.divIdSwap.divId+", minW: "+ads.divIdSwap.minW+" and maxW:"+ads.divIdSwap.maxW+", page width: "+width,classFunc);ads.divIdSwap.divIdOri=ads.divId;ads.divId=ads.divIdSwap.divId;ads.divIdSwap.swapped=true;IOL.adv.tools.logger("Try to set display:none for "+ads.divIdSwap.divIdOri,classFunc);if(document.getElementById(ads.divIdSwap.divIdOri)){document.getElementById(ads.divIdSwap.divIdOri).style.display='none';IOL.adv.tools.logger("set display:none for "+ads.divIdSwap.divIdOri,classFunc);}else
IOL.adv.tools.logger(ads.divIdSwap.divIdOri+" does not exist or is not ready yet",classFunc);if(document.getElementById(ads.divId)){document.getElementById(ads.divId).style.display='block';IOL.adv.tools.logger("set display:block for "+ads.divId,classFunc);}else
IOL.adv.tools.logger(ads.divId+" does not exist or is not ready yet",classFunc);}else{IOL.adv.tools.logger(id+" :: swap ads container not required, set display:none on swap container: "+ads.divIdSwap.divId+" ,minW: "+ads.divIdSwap.minW+" and maxW:"+ads.divIdSwap.maxW+", page width: "+width,classFunc);IOL.adv.tools.logger("Try to set display:none for "+ads.divIdSwap.divId,classFunc);if(document.getElementById(ads.divIdSwap.divId)){document.getElementById(ads.divIdSwap.divId).style.display='none';IOL.adv.tools.logger("set display:none for "+ads.divIdSwap.divId,classFunc);}else
IOL.adv.tools.logger(ads.divIdSwap.divId+" does not exist or is not ready yet",classFunc);ads.divIdSwap.swapped=false;}},validRangeSize:function(width,ads,id){var classFunc=IOL.adv.tools.classname+".validRangeSize";var extraDivIdToHide=false;ads.sizeIsCompliant=false;Object.keys(ads.validRangeSize).forEach(function(vKey){IOL.adv.tools.logger(id+" :: check validRangeSize for "+vKey,classFunc);var v=ads.validRangeSize[vKey];if(v){IOL.adv.tools.logger(id+" :: validRangeSize requested for "+vKey+" minW: "+v.minW+", maxW: "+v.maxW+", extraDivIdToHide: "+v.extraDivIdToHide,classFunc);if(!(width>=v.minW&&width<=v.maxW)){IOL.adv.tools.logger(id+" :: page width "+width+" is not compliant with min: "+v.minW+" and max: "+v.maxW,classFunc);v.isCompliant=false;if(v.extraDivIdToHide)extraDivIdToHide=v.extraDivIdToHide;}else{IOL.adv.tools.logger(id+" :: page width "+width+" is compliant with min: "+v.minW+" and max: "+v.maxW,classFunc);v.isCompliant=true;if(v.extraDivIdToHide)extraDivIdToHide=v.extraDivIdToHide;}}ads.sizeIsCompliant=ads.sizeIsCompliant||v.isCompliant;});if(!ads.sizeIsCompliant){IOL.adv.tools.logger(id+" :: page width is not compliant with validRangeSize, destroy ads",classFunc);if(document.getElementById(ads.divId)){document.getElementById(ads.divId).style.display='none';IOL.adv.tools.logger(id+" :: set display:none to "+ads.divId,classFunc);}if(extraDivIdToHide){if(document.getElementById(extraDivIdToHide)){IOL.adv.tools.logger(id+" :: set display:none to extraDivIdToHide:"+extraDivIdToHide,classFunc);document.getElementById(extraDivIdToHide).style.display='none';}else{IOL.adv.tools.logger(id+" :: extraDivIdToHide:"+extraDivIdToHide+" does not exist",classFunc);}}if(IOL.adv.settings.prebidjs)if(IOL.adv.settings.prebidjs.adUnits)IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.filterAdunitByCode,{code:ads.divId});delete IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];}else{IOL.adv.tools.logger(id+" :: page width is compliant with validRangeSize",classFunc);}},mEnable:function(m){var ret=false;if(IOL.adv.settings.modules)ret=(IOL.adv.settings.modules[m])?IOL.adv.settings.modules[m]:false;if(IOL.adv.tools.getParameterByName(m)=='on')ret=true;return ret;},asHandler:function(event){var classFunc=IOL.adv.classname+".asHandler";var refresh=false;try{if(event.data.from=='iam'&&event.data.action=='asStart'){if(IOL.adv.settings.dmp){if(IOL.adv.settings.dmp["1plusx"]){IOL.adv.tools.logger("start as handler 1plusx",classFunc);if(IOL.adv.settings.dmp["1plusx"].tagger.enable){var evt=new Object();if(IOL.adv.profile.up.value.ppid.iol){evt.type="1stparty-data";evt.ppid_iol=IOL.adv.profile.up.value.ppid.iol;}window.opeCustomEvents=[evt];IOL.adv.tools.logger("start 1plusx tagger injection...",classFunc);IOL.adv.tools.loadJs(IOL.adv.settings.dmp["1plusx"].tagger.url,function(){IOL.adv.settings.dmp["1plusx"].tagger.live=false;IOL.adv.tools.logger("1plusx tagger not loaded",classFunc);},function(){IOL.adv.settings.dmp["1plusx"].tagger.live=true;IOL.adv.tools.logger("1plusx tagger loaded",classFunc);},false);}IOL.adv.tools.logger("start 1plusx profile api request...",classFunc);if(IOL.adv.settings.dmp["1plusx"].api.enable){IOL.adv.tools.remoteCall(IOL.adv.settings.dmp["1plusx"].api.url+'?url='+encodeURIComponent(IOL.adv.url)+'&gdpr_applies='+((IOL.adv.gdpr.enable)?1:0)+'&consent_string='+IOL.adv.gdpr.consentString,"GET",true,function(r){IOL.adv.tools.logger("1plusx api loaded",classFunc);if(r){r=JSON.parse(r);IOL.adv.tools.logger("User Profile 1plusx: "+JSON.stringify(r),classFunc);if(r.s)IOL.adv.profile.as.value.s=r.s;if(r.t)IOL.adv.profile.as.value.t=r.t;}else
IOL.adv.tools.logger("User Profile 1plusx empty",classFunc);},2000);}}if(IOL.adv.settings.dmp["lotame"]){if(IOL.adv.cookie.get(IOL.adv.profile.as.cookie.name)){var v=JSON.parse(unescape(IOL.adv.cookie.get(IOL.adv.profile.as.cookie.name)));IOL.adv.profile.as.value.pid=v.pid;IOL.adv.profile.as.value.audienceId=v.audienceId;IOL.adv.profile.as.value.ts=v.ts;IOL.adv.profile.as.comingFrom="Cookie";IOL.adv.profile.as.duration=IOL.adv.tools.timer("",IOL.adv.profile.as.resource.url,"partial");IOL.adv.tools.logger("audience value: "+JSON.stringify(IOL.adv.profile.as.value)+" comingFrom: "+IOL.adv.profile.as.comingFrom,classFunc);if(!IOL.adv.profile.as.value.ts)IOL.adv.profile.as.value.ts=0;if((Date.now()-IOL.adv.profile.as.value.ts)>IOL.adv.profile.as.cookie.refresh)refresh=true;}else
refresh=true;IOL.adv.tools.logger("value refresh: "+refresh,classFunc);if(IOL.adv.settings.dmp["lotame"].tagger.enable){IOL.adv.tools.logger("start as handler lotame",classFunc);IOL.adv.tools.logger("start audience segment handler with clientId: "+IOL.adv.settings.dmp["lotame"].tagger.id,classFunc);IOL.adv.tools.loadJs(IOL.adv.settings.dmp["lotame"].tagger.url);window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];var targetingKey='lotame';var lotameClientId=IOL.adv.settings.dmp["lotame"].tagger.id;var audLocalStorageKey='lotame_'+lotameClientId+'_auds';var audienceReadyCallback=function(profile){IOL.adv.profile.as.value.pid=profile.getProfileId()||'';IOL.adv.profile.as.value.audienceId=profile.getAudiences()||[];if(IOL.adv.profile.as.value.pid!=''&&IOL.adv.profile.as.value.audienceId.length>0){IOL.adv.profile.as.value.ts=Date.now();IOL.adv.cookie.set(IOL.adv.profile.as.cookie.name,JSON.stringify(IOL.adv.profile.as.value),IOL.adv.profile.as.cookie.duration);}};var behaviors={};if((IOL.adv.domain===".paginebianche.it"||IOL.adv.domain===".paginegialle.it")&&IOL.adv.pubAdsCfg.customCriteria){var genp=[];var seat=(IOL.adv.domain===".paginebianche.it")?"pb_":"pg_";if(IOL.adv.pubAdsCfg.customCriteria.seat_categoria)genp.push(seat+"cat:"+IOL.adv.pubAdsCfg.customCriteria.seat_categoria);if(IOL.adv.pubAdsCfg.customCriteria.seat_keyword)genp.push(seat+"cat:"+IOL.adv.pubAdsCfg.customCriteria.seat_keyword);if(IOL.adv.pubAdsCfg.customCriteria.seat_settore)genp.push(seat+"cat:"+IOL.adv.pubAdsCfg.customCriteria.seat_settore);if(IOL.adv.pubAdsCfg.customCriteria.seat_geo1)genp.push(seat+"geo:"+IOL.adv.pubAdsCfg.customCriteria.seat_geo1);if(IOL.adv.pubAdsCfg.customCriteria.seat_geo2)genp.push(seat+"geo:"+IOL.adv.pubAdsCfg.customCriteria.seat_geo2);if(IOL.adv.pubAdsCfg.customCriteria.seat_geo3)genp.push(seat+"geo:"+IOL.adv.pubAdsCfg.customCriteria.seat_geo3);if(genp.length>0)behaviors.genp=genp;}var lotameTagInput={data:{thirdParty:{namespace:'ITLY',value:IOL.adv.profile.up.value.ppid.iol},behaviors:behaviors},config:{clientId:Number(lotameClientId),audienceLocalStorage:audLocalStorageKey,onProfileReady:audienceReadyCallback}};var lotameConfig=lotameTagInput.config||{};var namespace=window['lotame_'+lotameConfig.clientId]={};namespace.config=lotameConfig;if(!IOL.adv.profile.up.value.ppid.iol)delete lotameTagInput.data.thirdParty;if(Object.keys(behaviors).length===0)delete lotameTagInput.data.behaviors;IOL.adv.tools.logger("behaviors: "+JSON.stringify(lotameTagInput.data),classFunc);namespace.data=lotameTagInput.data||{};namespace.cmd=namespace.cmd||[];}}}else{if(refresh){IOL.adv.tools.logger("refresh audience calling the url: "+IOL.adv.profile.as.resource.url,classFunc);IOL.adv.tools.loadJs(IOL.adv.profile.as.resource.url,function(){IOL.adv.profile.as.resource.status='error';IOL.adv.profile.as.duration=IOL.adv.tools.timer("",IOL.adv.profile.as.resource.url,"partial");IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::"+IOL.adv.profile.as.resource.url+"::resourceLoadingError::"+IOL.adv.profile.as.duration;IOL.adv.tools.logger(IOL.adv.track.msg,'','error');if(IOL.adv.track.enable)IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);});}else
IOL.adv.tools.logger("audience is up to date",classFunc);}window.removeEventListener("message",IOL.adv.tools.asHandler);}}catch(e){}},asHandlerCallback:function(res){var classFunc=IOL.adv.tools.classname+".asHandlerCallback";IOL.adv.tools.logger("update audience on remoteCall:  "+JSON.stringify(res),classFunc);IOL.adv.profile.as.comingFrom="remoteCall";IOL.adv.profile.as.resource.status="loaded";IOL.adv.profile.as.duration=IOL.adv.tools.timer("",IOL.adv.profile.as.resource.url,"partial");if(res.Profile.pid){IOL.adv.profile.as.value.pid=res.Profile.pid;IOL.adv.profile.as.value.ts=Date.now();var l=res.Profile.Audiences.Audience.length;if(l>0){for(var i=0;i<l;i++){IOL.adv.profile.as.value.audienceId[i]=res.Profile.Audiences.Audience[i].id;}IOL.adv.cookie.set(IOL.adv.profile.as.cookie.name,JSON.stringify(IOL.adv.profile.as.value),IOL.adv.profile.as.cookie.duration);}}IOL.adv.tools.logger("audience value: "+JSON.stringify(IOL.adv.profile.as.value)+" comingFrom: "+IOL.adv.profile.as.comingFrom,classFunc);IOL.adv.tools.logger("audience has been updated",classFunc);},setAdunitPathByBidderCode:function(ad,bidder){var classFunc=IOL.adv.tools.classname+".setAdunitPathByBidderCode";var adUnit=false;IOL.adv.tools.logger("Start setAdunitPathByBidderCode on "+ad.divId+" for bidder: "+bidder,classFunc);if(IOL.adv.settings.prebidjs){var adUnit=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.getAdunitByCode,{code:ad.divId});if(adUnit.length>0){adUnit.find(IOL.adv.headerBidding.setAdunitPathByBidderCode,{'bidder':bidder,'adUnitPath':ad.adUnitPath});IOL.adv.tools.logger("adUnit value after setAdunitPathByBidderCode : "+JSON.stringify(adUnit),classFunc);}else
IOL.adv.tools.logger("No setAdunitPathByBidderCode is required for "+ad.divId,classFunc);}else
IOL.adv.tools.logger("No setAdunitPathByBidderCode is required for "+ad.divId,classFunc);return;},displayAds:function(p){var classFunc=IOL.adv.tools.classname+".displayAds";IOL.adv.complete=true;if(IOL.adv.pubAdsCfg.deferredDisplay){IOL.adv.tools.logger("deferredDisplay is enable, nothing to do",classFunc);IOL.adv.tools.logger("IAM complete",classFunc);return;}var slotContainer=(typeof p!=='undefined')?((typeof p.slotContainer!=='undefined')?p.slotContainer:false):false;var slotId=(typeof p!=='undefined')?((typeof p.slotId!=='undefined')?p.slotId:false):false;var mode=(typeof p!=='undefined')?((typeof p.mode!=='undefined')?p.mode:"standard"):"standard";var changeCorrelator=(typeof p!=='undefined')?((typeof p.changeCorrelator!=='undefined')?p.changeCorrelator:true):true;IOL.adv.tools.logger("slotId:"+slotId+", mode:"+mode+", changeCorrelator:"+changeCorrelator,classFunc);IOL.adv.tools.trkPerf("iamRenderingStart",Math.floor(performance.now()));switch(mode){case"display-slots":case"refresh-slots":if(slotContainer)googletag.pubads().refresh(slotContainer);else{var i=0;var l=Object.keys(IOL.adv.manager.slotsContainer).length-1;var a=[];Object.keys(IOL.adv.manager.slotsContainer).forEach(function(id){a[i]=IOL.adv.manager.slotsContainer[id];i++;});googletag.pubads().refresh(a,{changeCorrelator:changeCorrelator});}break;case"display-refresh-single":if(slotId){googletag.display(IOL.adv.manager.slotsContainer[slotId].getSlotElementId());googletag.pubads().refresh([IOL.adv.manager.slotsContainer[slotId]],{changeCorrelator:changeCorrelator});}break;case"refresh-single":if(slotId){googletag.pubads().refresh([IOL.adv.manager.slotsContainer[slotId]],{changeCorrelator:changeCorrelator});}break;case"display-refresh-all":if(slotId){googletag.display(IOL.adv.manager.slotsContainer[slotId].getSlotElementId());var i=0;var l=Object.keys(IOL.adv.manager.slotsContainer).length-1;var a=[];Object.keys(IOL.adv.manager.slotsContainer).forEach(function(id){a[i]=IOL.adv.manager.slotsContainer[id];i++;});googletag.pubads().refresh(a,{changeCorrelator:changeCorrelator});}break;case"display-single":default:if(slotId)googletag.display(IOL.adv.manager.slotsContainer[slotId].getSlotElementId());break;}try{if(typeof IamCallbackDfpCall==="function"){IOL.adv.tools.logger("Hook IamCallbackDfpCall",classFunc);IamCallbackDfpCall();}}catch(e){}IOL.adv.tools.logger("ads display order called",classFunc);IOL.adv.tools.logger("IAM complete",classFunc);},remoteCall:function(url,data,withCredentials,fn,timeout){var classFunc=IOL.adv.tools.classname+".remoteCall";var timeout=(timeout)?timeout:20000;var method=(data=="GET")?"GET":"POST";var data=(method=="GET")?"":data;IOL.adv.tools.logger("remoteCall url:"+url+", method: "+method,classFunc);try{var x=new XMLHttpRequest();if(fn){x.onreadystatechange=function(){if(x.readyState===XMLHttpRequest.DONE&&x.status===200){fn(x.responseText);}};}var useSSL='https:'==document.location.protocol;url=((useSSL||IOL.adv.pubAdsCfg.forceHttps)?'https:':'http:')+url;x.open(method,url,true);x.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");if(method=="GET")x.setRequestHeader("Referrer-Policy","no-referrer-when-downgrade");x.datatype="json";if(withCredentials)x.withCredentials=withCredentials;x.timeout=20000;x.send(data);}catch(e){IOL.adv.tools.logger("err remoteCall e:"+e.message,classFunc);}},getDomain:function(s){var d=s.split('.');if(d.length>2)d.shift();return'.'+d.join('.');},getParameterByName:function(name){var res=new RegExp('[\?&]'+name.replace(/\[/g,'\\\[').replace(/\]/g,'\\\]')+'(?:=([^&#]*))?(?:[&#]|$)').exec(window.location.search);return res?(res[1]?decodeURIComponent(res[1].replace(/\+/g,' ')):''):null;},extend:function(obj,src){for(var key in src){if(src.hasOwnProperty(key))obj[key]=src[key];}return obj;},digPadding:function(number,digits){return Array(Math.max(digits-String(number).length+1,0)).join(0)+number;},objAssigner:function(a,b){Object.keys(b).forEach(function(key){a[key]=b[key];});},getMetaTag:function(n,s){var v=[];try{var m=document.getElementsByTagName('meta')[n];if(m!=undefined){m=m.getAttribute("content");if(m!=undefined){if(s){m=m.split(s).filter(function(e){if(e)return true;});for(var i=0;i<m.length;i++){var val=m[i].replace(/\s/g,'')
if(val!='')v[i]=m[i].trim();}}else
v=m;}}}catch(e){}finally{return((v!=undefined)?v:false);}},getReferrerLabel:function(r,d){var classFunc=IOL.adv.tools.classname+".getReferrerLabel";var v=d;var map={'site':['.*'+IOL.adv.domain.replace(/\./g,'\\.')+'$'],'search':[/arianna\.libero\.it$/,/ricerca.*\.virgilio\.it$/,/.*\.google\.[a-z]{2,3}$/,/.*\.bing\.com$/,/.*\.ask\.[a-z]{2,3}$/,/.*\.hotbot\.[a-z]{2,3}$/,/.*\.dogpile\.[a-z]{2,3}$/,/.*\.lycos\.[a-z]{2,3}$/,/.*\.yandex\.[a-z]{2,3}$/,/.*\.exalead\.[a-z]{2,3}$/,/.*\.gigablast\.[a-z]{2,3}$/,/.*\.yahoo\.[a-z]{2,3}$/,/.*\.sogou\.[a-z]{2,3}$/,/.*\.search\.[a-z]{2,3}$/,/.*\.duckduckgo\.[a-z]{2,3}$/,/.*\.istella\.[a-z]{2,3}$/,/.*\.qwant\.[a-z]{2,3}$/,/.*\.searx\.[a-z]{2,3}$/,/.*\.qwant\.[a-z]{2,3}$/],'linked':[/.*\.italiaonline\.it$/,/.*\.virgilio\.it$/,/.*\.libero\.it$/,/.*\.buonissimo\.it$/,/.*\.dilei\.it$/,/.*\.quifinanza\.it$/,/.*\.siviaggia\.it$/,/.*\.supereva\.it$/,/.*\.myblog\.it$/,/.*\.xoom\.it$/,/.*\.initalia\.it$/,/.*\.paginebianche\.it$/,/.*\.paginegialle\.it$/,/.*\.tuttocitta\.it$/,/.*\.seat\.it$/]};IOL.adv.tools.logger("page domain: "+IOL.adv.domain+", referrer: "+r,classFunc);try{var refDomain=(new URL(r)).hostname.toLowerCase();refDomain=((!refDomain.startsWith('.'))?'.'+refDomain:refDomain);IOL.adv.tools.logger("Referrer domain: "+refDomain,classFunc);var found=false;Object.keys(map).forEach(function(k){for(var i=0;i<map[k].length&&v==d;i++){IOL.adv.tools.logger("Apply regEx: "+map[k][i]+" on domain: "+refDomain+" for case: "+k,classFunc);if(refDomain.match(map[k][i])){v=k;IOL.adv.tools.logger("Match found, assign label: "+v,classFunc);}}});}catch(e){IOL.adv.tools.logger("Referrer url is empty, return the default value: "+v,classFunc);}finally{return v;}},find:function(needle,haystack){var classFunc=IOL.adv.tools.classname+".setOptionalCustomParams";var found='';IOL.adv.tools.logger("needle:"+needle+" haystack:"+JSON.stringify(haystack),classFunc);if(needle&&haystack){IOL.adv.tools.logger("try to find needle in haystack",classFunc);found=((haystack[needle])?haystack[needle]:'');}IOL.adv.tools.logger("found: "+found,classFunc);return found;},filterArrayInArray:function(v){var classFunc=IOL.adv.tools.classname+".filterArrayInArray";var ret=true;this.list.forEach(function(prop){IOL.adv.tools.logger("prop:"+prop+" typeof v:"+typeof v+" value: "+v,classFunc);if(typeof v==="object"){if(v.join('x')==prop.join('x')){IOL.adv.tools.logger("Bad size found",classFunc);ret=false;}}else{IOL.adv.tools.logger("Bad size found or not managed",classFunc);ret=false;}});return ret;},randomId:function(){var f=function(){return(((1+Math.random())*0x10000)|0).toString(16).substring(1);};return(f()+f()+f()+f()+f()+f()+f()+f());},inject:function(l){var classFunc=IOL.adv.tools.classname+".inject";IOL.adv.tools.logger("Start manage library: "+l.url,classFunc);if(l.enable)if(l.condition)l.enable=eval(l.condition);IOL.adv.tools.logger("Status of library: "+l.url+", enable: "+l.enable+", mandatory: "+l.mandatory+", condition: "+l.condition,classFunc);IOL.adv.tools.timer(classFunc,l.url,"start");if(l.enable&&l.url!==''){IOL.adv.tools.timer(classFunc,l.url,"start");IOL.adv.tools.loadJs(l.url,function(){l.live=true;l.status='error';l.duration=IOL.adv.tools.timer(classFunc,l.url,"partial");IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::"+l.url+"::resourceLoadingError::"+l.duration;IOL.adv.tools.logger(IOL.adv.track.msg,classFunc,'error');if(IOL.adv.track.enable)IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);if(IOL.adv.track.resourceLoadingError){IOL.adv.tools.trkPerf("iamResourceLoadingError",Math.floor(performance.now()));IOL.adv.track.resourceLoadingError=false;}if(l.onError)l.onError();},function(){if(l.onLoad)l.onLoad();l.live=true;l.status="loaded";l.duration=IOL.adv.tools.timer(classFunc,l.url,"partial");IOL.adv.tools.logger("Time elapsed for loading "+l.url+" is "+l.duration,classFunc);},(l.id)?l.id:false);}},cmpHandler:function(initiator,callback,fallback,timer,wait){var classFunc=IOL.adv.tools.classname+".cmpHandler,"+initiator;var timer=timer?timer:false;var wait=wait?wait:true;if(IOL.adv.gdpr.tcfv20.enable)IOL.adv.gdpr.enable=IOL.adv.gdpr.tcfv20.enable;if(IOL.adv.gdpr.enable){IOL.adv.tools.logger("cmp is ready, run callback function",classFunc);callback();return;}if(wait){IOL.adv.tools.logger("cmp is not ready yet, try with setInterval",classFunc);var iteration=0;timer=setInterval(function(){IOL.adv.gdpr.enable=((typeof __tcfapi==='function')?true:false);if(IOL.adv.gdpr.enable){clearInterval(timer);IOL.adv.tools.logger("cmp is ready",classFunc);callback();}else{if(iteration>IOL.adv.gdpr.maxIteration){clearInterval(timer);IOL.adv.tools.logger("cmp is not ready, run fallback or callback function",classFunc);if(fallback)fallback();else
callback();if(IOL.adv.track.enable){IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::notcfapi::";IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);IOL.adv.tools.logger('cmp is missing: '+IOL.adv.track.msg,classFunc,'error');}}else{iteration++;IOL.adv.tools.logger("cmp is not ready yet, please wait...",classFunc);}}},IOL.adv.gdpr.interval);}else{callback();}},trkPerf:function(evnt,time){var classFunc=IOL.adv.tools.classname+".trkPerf";try{if(!IOL.adv.tools.mEnable("trkPerf")){IOL.adv.tools.logger("Track druid disable",classFunc);return;}if(IOL.adv.track.druidContainer[evnt]){IOL.adv.tools.logger("Track already done for "+evnt,classFunc);return;}IOL.adv.track.druidContainer[evnt]=time;var t,w,d;try{t=Date.now();}catch(er){t=0;}try{w=screen.width;}catch(er){w=0;}try{d=window.location.hostname;}catch(e){d='error';}var url="https://evnt.iol.it/v2?&pgnf="+d+"%2Call%2C%2C%2C%2C0%2C"+w+"%2C0%2C%2Cb%2C0%2C%2C"+evnt+"%2C"+time+"&nc="+t;var i=new Image();i.src=url;IOL.adv.tools.logger("track: "+evnt,classFunc);}catch(err){IOL.adv.tools.logger("track exception: "+err,classFunc,'error');}},trkGdpr:function(){var classFunc=IOL.adv.tools.classname+".trkGdpr";try{if(!IOL.adv.tools.mEnable("trkGdpr")){IOL.adv.tools.logger("Track druid disable",classFunc);return;}var gdprStatus='GoogleTrue';if(!IOL.adv.gdpr.tcfv20.tcData)gdprStatus='TCDataFalse';else{var purposeConsentsLength=-1;var purposeLegitimateInterestsLength=-1;var vendorConsentsLength=-1;var vendorLegitimateInterestsLength=-1;if(IOL.adv.gdpr.tcfv20.tcData.purpose){if(IOL.adv.gdpr.tcfv20.tcData.purpose.consents)purposeConsentsLength=Object.keys(IOL.adv.gdpr.tcfv20.tcData.purpose.consents).length;if(IOL.adv.gdpr.tcfv20.tcData.purpose.legitimateInterests)purposeLegitimateInterestsLength=Object.keys(IOL.adv.gdpr.tcfv20.tcData.purpose.legitimateInterests).length;}if(IOL.adv.gdpr.tcfv20.tcData.vendor){if(IOL.adv.gdpr.tcfv20.tcData.vendor.consents)vendorConsentsLength=Object.keys(IOL.adv.gdpr.tcfv20.tcData.vendor.consents).length;if(IOL.adv.gdpr.tcfv20.tcData.vendor.legitimateInterests)vendorLegitimateInterestsLength=Object.keys(IOL.adv.gdpr.tcfv20.tcData.vendor.legitimateInterests).length;}if(IOL.adv.gdpr.tcfv20.tcData.purpose&&vendorConsentsLength>=0&&vendorLegitimateInterestsLength>=0){if(IOL.adv.gdpr.tcfv20.tcData.purpose.consents[1]==false||IOL.adv.gdpr.tcfv20.tcData.vendor.consents[755]==false||IOL.adv.gdpr.tcfv20.tcData.vendor.legitimateInterests[755]==false||vendorConsentsLength==0||vendorLegitimateInterestsLength==0){gdprStatus='GoogleFalse';}}if(IOL.adv.gdpr.tcfv20.tcData.purpose)if(IOL.adv.gdpr.tcfv20.tcData.purpose.consents[1]==false)gdprStatus='Purpose1false';if(purposeConsentsLength==0&&purposeLegitimateInterestsLength==0&&vendorConsentsLength==0&&vendorLegitimateInterestsLength==0)gdprStatus='RejectAll';if(vendorConsentsLength==-1||(vendorConsentsLength>0&&IOL.adv.gdpr.tcfv20.tcData.vendor.consents[755]===undefined)||vendorLegitimateInterestsLength==-1||(vendorLegitimateInterestsLength>0&&IOL.adv.gdpr.tcfv20.tcData.vendor.legitimateInterests[755]===undefined)){gdprStatus='GoogleBad';}}}catch(err){gdprStatus='Exception';IOL.adv.tools.logger("gdpr track exception: "+err,classFunc,'error');}try{var t,r,w,d,e;try{t=Date.now();}catch(er){t=0;}try{r=Math.floor(performance.now());}catch(e){r=0;}try{w=screen.width;}catch(er){w=0;}try{d=window.location.hostname;}catch(e){d='error';}e='iamConsent'.concat(gdprStatus);var url="https://evnt.iol.it/v2?&pgnf="+d+"%2Call%2C%2C%2C%2C0%2C"+w+"%2C0%2C%2Cb%2C0%2C%2C"+e+"%2C"+r+"&nc="+t;var i=new Image();i.src=url;IOL.adv.tools.logger("track event: "+e,classFunc);}catch(e){IOL.adv.tools.logger("img append exception: "+e,classFunc,'error');}},reloadPageInDebugMode:function(){var _url=location.href;_url=(_url.indexOf('?')!==-1)?_url+'&iam_console={"log":true}':_url+'?iam_console={"log":true}';window.location.href=_url;},reloadPageWithConsole:function(){var _url=location.href;_url=(_url.indexOf('?')!==-1)?_url+'&iam_console={"console":true}':_url+'?iam_console={"console":true}';window.location.href=_url;}}}if(!window.iamInitialized){IOL.adv.cookie={get:function(name){var ret=false;var aCookieName=name.split(',');var aCookie=document.cookie.split(';');var l=aCookie.length;for(var j=0;j<aCookieName.length;j++){var nameEQ=aCookieName[j]+"=";for(var i=0;i<l;i++){var c=aCookie[i];while(c.charAt(0)==' '){c=c.substring(1,c.length);}if(c.indexOf(nameEQ)===0){ret=c.substring(nameEQ.length,c.length);}}}return ret;},getProfileEnable:function(){if(IOL.adv.gdpr.tcfv20.pipeline.policyCookie){var cValue=IOL.adv.cookie.get(IOL.adv.gdpr.tcfv20.pipeline.policyCookie);return(cValue=='on')?true:false;}var cValue=IOL.adv.cookie.get('policy_cookie');if(!cValue)return false;else{return(cValue[3]=='1'?true:false);}},set:function(cName,cValue,cDays,cPath,cDomain){var expires=new Date();expires.setDate(expires.getDate()+cDays);document.cookie=cName+"="+escape(cValue)+((cDays===null)?"":"; expires="+expires.toUTCString())+"; Secure; SameSite=Strict; path="+((typeof cPath==="undefined")?"/":cPath)+"; domain="+((cDomain)?cDomain:IOL.adv.domain);},erase:function(cName,cDomain){this.set(cName,"",-1,"/",cDomain);},enabled:function(){this.set(IOL.adv.domain,"probe","ok",1);var enabled=this.get("probe")=='ok';this.set(IOL.adv.domain,"probe","",-1);return enabled;}}}if(!window.iamInitialized){IOL.adv.settings={classname:"IOL.adv.settings",ns:"libero.web.community.siti.1.2",modules:{"aax":false,"zeotap":false,"pih":true,"lotameimprove":true,"trkPerf":false,"trkGdpr":false},library:{"platform":{enable:true,mandatory:true,url:"//securepubads.g.doubleclick.net/tag/js/gpt.js",live:false},"prebid":{enable:true,mandatory:false,url:"//www.iolam.it/js/prebid.js",live:false,condition:"IOL.adv.pubAdsCfg.prebid"},"amazon":{enable:true,mandatory:false,url:"//c.amazon-adsystem.com/aax2/apstag.js",live:false,condition:"IOL.adv.pubAdsCfg.prebid"},"intersectionObserver":{enable:true,mandatory:false,url:"//www.iolam.it/js/polyfill/intersection-observer.js",live:false,condition:"typeof IntersectionObserver!=='function' && IOL.adv.pubAdsCfg.lazy"}},dmp:{"1plusx":{"tagger":{enable:false,url:"//tagger.opecloud.com/italiaonline/v2/tcf-tagger.js",live:false},"api":{enable:false,url:"//italiaonline.profiles.tagger.opecloud.com/v1/targeting"}},"lotame":{"tagger":{enable:true,id:6201,url:"//tags.crwdcntrl.net/lt/c/6201/lt.min.js",live:false}}},disableInitialLoad:false,enableSingleRequest:true,enableAsyncRendering:true,lazy:{observer:{obj:null,options:{threshold:[0.001],rootMargin:"400px 0px 400px 0px"}},divIdSlotIdMap:{}},slots:{"default":{fnInit:'IOL.adv.settings.fnInit()',ads:{"ad72890top":{adUnitPath:"/5180/libero/community/digiland/top",divId:"ad72890top",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"adleftcol":{adUnitPath:"/5180/libero/community/digiland/leftcol",divId:"adleftcol",optional:true,size:[[160,600]],sizeMapping:{"desktop":[[970,10],[[160,600]]]},validRangeSize:{"tablet,desktop":{minW:970,maxW:9999}},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"adrightcol":{adUnitPath:"/5180/libero/community/digiland/rightcol",divId:"adrightcol",optional:true,size:[[160,600]],sizeMapping:{"desktop":[[970,10],[[160,600]]]},validRangeSize:{"tablet,desktop":{minW:970,maxW:9999}},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"admpufoot":{adUnitPath:"/5180/libero/community/chat/foot",divId:"admpufoot",optional:true,size:[[300,250]],sizeMapping:{"desktop":[[1024,10],[[300,250]]],"tablet":[[728,10],[[300,250]]],"mobile":[[320,10],[[300,250]]],"any":[[0,0],[]]},followOnScroll:true,setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:'IOL.adv.settings.fnAfterAdMpuTop(id, ad)'},"ad72890bottom":{adUnitPath:"/5180/libero/community/digiland/bottom",divId:"ad72890bottom",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},followOnScroll:true,setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:'IOL.adv.settings.fnAfterAdMpuTop(id, ad)'}},fnFinally:false},"digispazio":{fnInit:'IOL.adv.settings.fnInit()',ads:{"ad72890top":{adUnitPath:"/5180/libero/community/digiland/top",divId:"ad72890top",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"ad72890bottom":{adUnitPath:"/5180/libero/community/digiland/bottom",divId:"ad72890bottom",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},followOnScroll:true,setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:'IOL.adv.settings.fnAfterAdMpuTop(id, ad)'}},fnFinally:false},"test":{fnInit:'IOL.adv.settings.fnInit()',ads:{"ad72890top":{adUnitPath:"/5180/testiol/libero/community/test%PLACEHOLDER%/top",divId:"ad72890top",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"adleftcol":{adUnitPath:"/5180/testiol/libero/community/test%PLACEHOLDER%/leftcol",divId:"adleftcol",optional:true,size:[[160,600]],sizeMapping:{"desktop":[[970,10],[[160,600]]]},validRangeSize:{"tablet,desktop":{minW:970,maxW:9999}},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"adrightcol":{adUnitPath:"/5180/testiol/libero/community/test%PLACEHOLDER%/rightcol",divId:"adrightcol",optional:true,size:[[160,600]],sizeMapping:{"desktop":[[970,10],[[160,600]]]},validRangeSize:{"tablet,desktop":{minW:970,maxW:9999}},setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:false},"ad72890bottom":{adUnitPath:"/5180/testiol/libero/community/test%PLACEHOLDER%/top",divId:"ad72890bottom",size:[[728,90],[320,100],[320,50]],sizeMapping:{"desktop":[[1024,10],[[728,90]]],"tablet":[[728,10],[[728,90]]],"mobile":[[320,10],[[320,100],[320,50]]],"any":[[0,0],[]]},followOnScroll:true,setCollapseEmptyDiv:[true,true],forceSafeFrame:false,bidAmazon:true,fnBefore:false,fnAfter:'IOL.adv.settings.fnAfterAdMpuTop(id, ad)'}},fnFinally:false}},fnInit:function(){var classFunc=IOL.adv.settings.classname+".fnInit";var extendedCustomCriteria={map:null};var adv_type=[];if(IOL.adv.pubAdsCfg.inread===true)adv_type.push("inread");if(adv_type.length>0)extendedCustomCriteria.map={"adv_type":{condition:true,value:adv_type}};IOL.adv.manager.customCriteria.map=IOL.adv.tools.extend(IOL.adv.manager.customCriteria.map,extendedCustomCriteria.map);if(IOL.adv.pubAdsCfg.prestitial){IOL.adv.settings.openPrestitial();}},fnFinally:function(){var classFunc=IOL.adv.settings.classname+".fnFinally";},fnAfterAdMpuTop:function(id,ad){googletag.pubads().addEventListener('slotRenderEnded',function(event){var classFunc=IOL.adv.settings.classname+".fnAfterAdMpuTop";try{var slotId=event.slot.getSlotElementId();IOL.adv.tools.logger("slotId: "+slotId+" ad.divId: "+ad.divId+" event.isEmpty: "+event.isEmpty,classFunc);if(slotId==ad.divId&&ad.followOnScroll&&!event.isEmpty&&event.size){var w=event.size[0];var h=event.size[1];if(IOL.adv.headerBidding.enable){Object.keys(pbjs.getAllWinningBids()).forEach(function(key){IOL.adv.tools.logger("HeaderBidding Winning Bids: "+pbjs.getAllWinningBids()[key].adUnitCode,classFunc);if(pbjs.getAllWinningBids()[key].adUnitCode==ad.divId){w=pbjs.getAllWinningBids()[key].width;h=pbjs.getAllWinningBids()[key].height;IOL.adv.tools.logger("Get size from HeaderBidding Winning Bids",classFunc);}});}IOL.adv.tools.logger("ads size: "+w+"x"+h,classFunc);if(w==300&&h==250)if(typeof fixAdv=='function'){IOL.adv.tools.logger("Run fixAdv client function on "+event.slot.getSlotElementId()+" w:"+w+" h:"+h,classFunc);fixAdv({prt:'.colDx',obj:'.adv',w:w,h:h});}else
IOL.adv.tools.logger("function fixAdv does not exist.",classFunc);}}catch(e){}});}}
IOL.adv.settings.prebidjs={adUnits:[{code:'ad72890top',mediaTypes:{banner:{sizes:[[728,90]]}},bids:[{bidder:'appnexus',labelAny:['desktop'],params:{placementId:12485938}},{bidder:'criteo',labelAny:['desktop'],params:{networkId:1994,publisherSubId:'Libero.Community_Desktop_adwallpaper'}},{bidder:'pubmatic',labelAny:['desktop'],params:{publisherId:'83172',adSlot:'1940876@728x90'}},{bidder:'rubicon',labelAny:['desktop'],params:{zoneId:'1216344',siteId:'129440',accountId:'11334',position:'atf'}},{bidder:'onetag',labelAny:['desktop'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['desktop'],params:{uid:35061,useNewFormat:true}}]},{code:'ad72890top',mediaTypes:{banner:{sizes:[[728,90]]}},bids:[{bidder:'appnexus',labelAny:['tablet'],params:{placementId:12485939}},{bidder:'criteo',labelAny:['tablet'],params:{networkId:1994,publisherSubId:'Libero.Community_MobileWeb_adwallpaper'}},{bidder:'pubmatic',labelAny:['tablet'],params:{publisherId:'83172',adSlot:'1940888@728x90'}},{bidder:'rubicon',labelAny:['tablet'],params:{zoneId:'1216368',siteId:'246088',accountId:'11334',position:'atf'}},{bidder:'onetag',labelAny:['tablet'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['tablet'],params:{uid:35061,useNewFormat:true}}]},{code:'adwallpapermob',mediaTypes:{banner:{sizes:[[320,50]]}},bids:[{bidder:'appnexus',labelAny:['mobile'],params:{placementId:16274408}},{bidder:'criteo',labelAny:['mobile'],params:{networkId:1994,publisherSubId:'Libero.Community_MobileWeb_adtop_320x50'}},{bidder:'pubmatic',labelAny:['mobile'],params:{publisherId:'83172',adSlot:'2172702@320x50'}},{bidder:'rubicon',labelAny:['mobile'],params:{zoneId:'1327388',siteId:'246088',accountId:'11334',position:'atf'}},{bidder:'onetag',labelAny:['mobile'],params:{pubId:'389a1a1c29'}},{bidder:'improvedigital',labelAny:['mobile'],params:{placementId:22045075}},{bidder:'grid',labelAny:['mobile'],params:{uid:35060,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[728,90]]}},code:'ad72890bottom',bids:[{bidder:'appnexus',labelAny:['desktop'],params:{placementId:12564165}},{bidder:'criteo',labelAny:['desktop'],params:{networkId:1994,publisherSubId:'Libero.Community_Desktop_adleaderboardfoot'}},{bidder:'pubmatic',labelAny:['desktop'],params:{publisherId:'83172',adSlot:'1940878@728x90'}},{bidder:'rubicon',labelAny:['desktop'],params:{zoneId:'1216346',siteId:'129440',accountId:'11334',position:'btf'}},{bidder:'onetag',labelAny:['desktop'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['desktop'],params:{uid:35056,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[728,90]]}},code:'ad72890bottom',bids:[{bidder:'appnexus',labelAny:['mobile','tablet'],params:{placementId:15101965}},{bidder:'criteo',labelAny:['mobile','tablet'],params:{networkId:1994,publisherSubId:'Libero.Community_MobileWeb_adleaderboardfoot'}},{bidder:'pubmatic',labelAny:['mobile','tablet'],params:{publisherId:'83172',adSlot:'1940889@728x90'}},{bidder:'rubicon',labelAny:['mobile','tablet'],params:{zoneId:'1216374',siteId:'246088',accountId:'11334',position:'btf'}},{bidder:'onetag',labelAny:['mobile','tablet'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['tablet'],params:{uid:35062,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[160,600]]}},code:'adleftcol',bids:[{bidder:'appnexus',labelAny:['mobile','tablet','desktop'],params:{placementId:16274401}},{bidder:'criteo',labelAny:['mobile','tablet','desktop'],params:{networkId:1994,publisherSubId:'Libero.Community_Desktop_adrightcol_160x600'}},{bidder:'pubmatic',labelAny:['mobile','tablet','desktop'],params:{publisherId:'83172',adSlot:'2172700@160x600'}},{bidder:'rubicon',labelAny:['mobile','tablet','desktop'],params:{zoneId:'1327374',siteId:'129440',accountId:'11334',position:'atf'}},{bidder:'onetag',labelAny:['mobile','tablet','desktop'],params:{pubId:'389a1a1c29'}},{bidder:'improvedigital',labelAny:['mobile','tablet','desktop'],params:{placementId:22045074}},{bidder:'grid',labelAny:['tablet','desktop'],params:{uid:35059,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[160,600]]}},code:'adrightcol',bids:[{bidder:'appnexus',labelAny:['mobile','tablet','desktop'],params:{placementId:16274401}},{bidder:'criteo',labelAny:['mobile','tablet','desktop'],params:{networkId:1994,publisherSubId:'Libero.Community_Desktop_adrightcol_160x600'}},{bidder:'pubmatic',labelAny:['mobile','tablet','desktop'],params:{publisherId:'83172',adSlot:'2172700@160x600'}},{bidder:'rubicon',labelAny:['mobile','tablet','desktop'],params:{zoneId:'1327374',siteId:'129440',accountId:'11334',position:'atf'}},{bidder:'onetag',labelAny:['mobile','tablet','desktop'],params:{pubId:'389a1a1c29'}},{bidder:'improvedigital',labelAny:['mobile','tablet','desktop'],params:{placementId:22045074}},{bidder:'grid',labelAny:['tablet','desktop'],params:{uid:35059,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[300,250]]}},code:'admpufoot',bids:[{bidder:'appnexus',labelAny:['mobile','tablet'],params:{placementId:12485940}},{bidder:'criteo',labelAny:['mobile','tablet'],params:{networkId:1994,publisherSubId:'Libero.Community_MobileWeb_admpufoot'}},{bidder:'pubmatic',labelAny:['mobile','tablet'],params:{publisherId:'83172',adSlot:'1940887@300x250'}},{bidder:'rubicon',labelAny:['mobile','tablet'],params:{zoneId:'1216364',siteId:'246088',accountId:'11334',position:'btf'}},{bidder:'onetag',labelAny:['mobile','tablet'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['mobile','tablet'],params:{uid:35063,useNewFormat:true}}]},{mediaTypes:{banner:{sizes:[[300,250]]}},code:'admpufoot',bids:[{bidder:'appnexus',labelAny:['desktop'],params:{placementId:12485935}},{bidder:'criteo',labelAny:['desktop'],params:{networkId:1994,publisherSubId:'Libero.Community_Desktop_admpufoot'}},{bidder:'pubmatic',labelAny:['desktop'],params:{publisherId:'83172',adSlot:'1940875@300x250'}},{bidder:'rubicon',labelAny:['desktop'],params:{zoneId:'1216340',siteId:'129440',accountId:'11334',position:'btf'}},{bidder:'onetag',labelAny:['desktop'],params:{pubId:'389a1a1c29'}},{bidder:'grid',labelAny:['desktop'],params:{uid:35057,useNewFormat:true}}]}]}}if(!window.iamInitialized){IOL.adv.manager={classname:"IOL.adv.manager",trackingMsg:"",divIdReady:false,divIdReadyList:[],slotsContainer:[],refreshSlotsContainer:[],originalSlotsContainer:[],lastSlotIdReady:"",videoAds:false,videoOnly:false,deferredIteration:0,deferredMaxIteration:1000,deferredInterval:20,deferredTimer:null,customCriteria:{map:{},set:[],duration:""},init:function init(fn){var classFunc=IOL.adv.manager.classname+".init";IOL.adv.tools.timer(classFunc,"Function","start");IOL.adv.tools.logger("Start function",classFunc);try{if(typeof IamCallbackInitialize==="function"){IOL.adv.tools.logger("Hook IamCallbackInitialize",classFunc);IamCallbackInitialize();}}catch(e){}IOL.adv.manager.videoAds=false;IOL.adv.manager.videoOnly=false;if(IOL.adv.profile.up.value.ppid.gm&&IOL.adv.profile.enable){IOL.adv.tools.logger("Start refine handler","IOL.adv.refine");window._adftrack=Array.isArray(window._adftrack)?window._adftrack:(window._adftrack?[window._adftrack]:[]);window._adftrack.push({pm:1253522,divider:encodeURIComponent('|'),pagename:encodeURIComponent('nc'),order:{sv1:'1',sv2:'0',sv3:'413',sv4:'0',sv5:IOL.adv.profile.up.value.ppid.gm,sv6:'1',sv7:'true',sv8:'2'}});(function(){var s=document.createElement('script');s.type='text/javascript';s.async=true;s.src='https://track.adform.net/serving/scripts/trackpoint/async/';var x=document.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);})();}if(IOL.adv.settings.library.neustarPG)if(IOL.adv.settings.library.neustarPG.enable&&IOL.adv.settings.library.neustarPG.live&&Tapad){var metadata={gdpr:(IOL.adv.gdpr.enable)?1:0,gdpr_consent:(IOL.adv.gdpr.consentString)?IOL.adv.gdpr.consentString:"",bp_id:"iolitaly",};var config={name:"P&G",pixelUrl:IOL.adv.settings.library.neustarPG.pixelUrl};var tagger=Tapad.init(metadata,config);var data={};tagger.sync(data);}if(IOL.adv.pubAdsCfg.dynamicAds.enable)IOL.adv.pubAdsCfg.dynamicAds.id.forEach(function(e,idx){IOL.adv.manager.createAds(e,idx);})
Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(key){var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[key];ad.mediaType=(ad.mediaType!==undefined)?ad.mediaType:'display';ad.size=(ad.size==undefined)?[]:ad.size;ad.lazy=(ad.lazy!==undefined)?ad.lazy:true;ad.optional=(ad.optional!==undefined)?ad.optional:false;ad.sizeIsCompliant=true;if(!IOL.adv.pubAdsCfg.deferredDivId&&ad.optional!==true)ad.divIdReady=true;ad.adUnitPath=IOL.adv.getAdUnitPath(key);IOL.adv.tools.logger(key+" :: adUnitPath: "+ad.adUnitPath,classFunc);if(ad.mediaType=='video')ad.size=[[640,480]];IOL.adv.tools.logger(key+" :: ad.size: "+ad.size,classFunc);if(ad.validRangeSize){IOL.adv.tools.logger(key+" :: validRangeSize has been requested",classFunc);IOL.adv.tools.validRangeSize(IOL.adv.pageWidth,ad,key);}if(ad.divIdSwap){IOL.adv.tools.logger(key+" :: divIdSwap has been requested",classFunc);IOL.adv.tools.divIdSwap(IOL.adv.pageWidth,ad,key);}if(ad.mediaType=='video')IOL.adv.manager.videoAds=true;});if(Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).length==1&&IOL.adv.manager.videoAds){IOL.adv.manager.videoOnly=true;IOL.adv.tools.logger("This slot contains a single ads with mediaType video",classFunc);}IOL.adv.tools.logger("deferredDivId is: "+IOL.adv.pubAdsCfg.deferredDivId,classFunc);if(IOL.adv.pubAdsCfg.deferredDivId)IOL.adv.manager.deferredTimer=setInterval(function(){IOL.adv.manager.deferredDivIdReady(fn)},IOL.adv.manager.deferredInterval);else
fn();IOL.adv.tools.logger("End function, Time elapsed is:  "+IOL.adv.tools.timer(classFunc,"Function","partial"),classFunc);},deferredDivIdReady:function(fn){var classFunc=IOL.adv.manager.classname+".deferredDivIdReady";IOL.adv.manager.divIdReady=IOL.adv.tools.divIdsReady(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads,IOL.adv.manager.divIdReadyList);IOL.adv.tools.logger("document.readyState:"+document.readyState+", divIdReady:"+IOL.adv.manager.divIdReady+", deferredMaxIteration:"+IOL.adv.manager.deferredMaxIteration+", deferredIteration: "+IOL.adv.manager.deferredIteration+", deferredInterval (ms.):"+this.deferredInterval,classFunc);if(IOL.adv.manager.deferredIteration<=IOL.adv.manager.deferredMaxIteration){if(IOL.adv.manager.divIdReady||document.readyState!=='loading'){IOL.adv.tools.logger("deferredDivIdReady status: true, ready ads: ["+IOL.adv.manager.divIdReadyList+"], iteration: "+IOL.adv.manager.deferredIteration,classFunc);clearInterval(IOL.adv.manager.deferredTimer);fn();}else{IOL.adv.manager.deferredIteration++;IOL.adv.tools.logger("status false, retry:: deferredMaxIteration:"+IOL.adv.manager.deferredMaxIteration+" deferredIteration: "+IOL.adv.manager.deferredIteration,classFunc);}}else{clearInterval(IOL.adv.manager.deferredTimer);fn();IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::divIdNotReady";IOL.adv.tools.logger(IOL.adv.track.msg,classFunc,"error");if(IOL.adv.track.enable)IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);IOL.adv.tools.logger("status false, failed:: deferredMaxIteration:"+IOL.adv.manager.deferredMaxIteration+" deferredIteration: "+IOL.adv.manager.deferredIteration,classFunc);}},run:function(){var classFunc=IOL.adv.manager.classname+".run";if(Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).length>0){if(!IOL.adv.pubAdsCfg.deferredRun&&!IOL.adv.settings.deferredHeaderBiddingInit)IOL.adv.headerBidding.init(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads,((typeof IOL.adv.settings.prebidjs!=='undefined')?IOL.adv.settings.prebidjs.adUnits:false),false);if(IOL.adv.manager.videoOnly){IOL.adv.manager.runVideoOnly();IOL.adv.tools.logger("run in videoOnly mode ",classFunc);}else{IOL.adv.tools.logger("run in display mode and video if defined",classFunc);IOL.adv.manager.runDisplay();}}else{IOL.adv.complete=true;IOL.adv.tools.logger("IAM complete, no ads to display",classFunc);}},runDisplay:function(){var classFunc=IOL.adv.manager.classname+".runDisplay";var googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){IOL.adv.tools.logger("Start function. ",classFunc);var companionVideo=false;if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit){IOL.adv.tools.logger("Run fnInit on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit);}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer)if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit){IOL.adv.tools.logger("Run fnInit on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit);}if(Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).length==0){IOL.adv.complete=true;IOL.adv.tools.logger("IAM complete, no ads to display",classFunc);return;}IOL.adv.pubAdsCfg.lazy=IOL.adv.pubAdsCfg.lazy&&(typeof IntersectionObserver==='function'&&typeof IOL.adv.settings.lazy!=='undefined')?true:false;if(IOL.adv.pubAdsCfg.lazy){IOL.adv.settings.enableAsyncRendering=true;IOL.adv.settings.disableInitialLoad=true;IOL.adv.tools.logger("Lazy enable, init IntersectionObserver",classFunc);IOL.adv.settings.lazy.observer.obj=new IntersectionObserver(function onEntry(entries){var l=entries.length;for(var i=0;i<l;i++){var entry=entries[i];IOL.adv.tools.logger("IntersectionObserver: div: "+entry.target.id+", ratio: "+entry.intersectionRatio,classFunc);if(entry.intersectionRatio>0){IOL.adv.tools.logger("IntersectionObserver: "+entry.target.id+" is visible, remove observer, display ads",classFunc);IOL.adv.settings.lazy.observer.obj.unobserve(document.getElementById(entry.target.id));var slotId=IOL.adv.settings.lazy.divIdSlotIdMap[entry.target.id];IOL.adv.tools.displayAds({slotId:slotId,mode:"display-refresh-single",changeCorrelator:false});}}},IOL.adv.settings.lazy.observer.options);}if(IOL.adv.profile.enable){if(IOL.adv.profile.up.value.ppid.iol){googletag.pubads().setPublisherProvidedId(IOL.adv.profile.up.value.ppid.iol);IOL.adv.tools.logger("setPublisherProvidedId: "+IOL.adv.profile.up.value.ppid.iol,classFunc);}}else{googletag.pubads().setRequestNonPersonalizedAds(1);}IOL.adv.settings.disableInitialLoad?googletag.pubads().disableInitialLoad():false;IOL.adv.settings.enableSingleRequest?googletag.pubads().enableSingleRequest():false;IOL.adv.settings.enableAsyncRendering?googletag.pubads().enableAsyncRendering():false;Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(id){IOL.adv.tools.logger("Start manage ads "+id,classFunc);var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];if(ad.fnBefore){IOL.adv.tools.logger(id+" run fnBefore",classFunc);eval(ad.fnBefore);}if(IOL.adv.pubAdsCfg.lazy&&ad.lazy!==false){ad.setCollapseEmptyDiv=[false,false];}if(ad.sizeIsCompliant&&ad.divIdReady!==true)ad.divIdReady=IOL.adv.tools.divIdReady(ad);if(ad.divIdReady){if(ad.mediaType==='display'){IOL.adv.tools.logger(ad.divId+" is ready, run googletag defineSlot",classFunc);IOL.adv.manager.lastSlotIdReady=id;if(ad.outOfPage)IOL.adv.manager.slotsContainer[id]=googletag.defineOutOfPageSlot(ad.adUnitPath.trim(),ad.divId).addService(googletag.pubads());else{IOL.adv.manager.slotsContainer[id]=googletag.defineSlot(ad.adUnitPath.trim(),ad.size,ad.divId).addService(googletag.pubads());}if(ad.companionVideo){IOL.adv.tools.logger("Ads settings of "+id+" :: companionVideo: "+ad.companionVideo,classFunc);companionVideo=true;IOL.adv.manager.slotsContainer[id].addService(googletag.companionAds());}ad.setCollapseEmptyDiv?IOL.adv.manager.slotsContainer[id].setCollapseEmptyDiv(ad.setCollapseEmptyDiv[0],ad.setCollapseEmptyDiv[1]):false;if(ad.sizeMapping){IOL.adv.tools.logger("Start define sizeMapping for "+ad.divId,classFunc);var sizeMapping=googletag.sizeMapping();Object.keys(ad.sizeMapping).forEach(function(dimension){IOL.adv.tools.logger(ad.divId+" enable sizeMapping for dimension: "+dimension+" with size: "+ad.sizeMapping[dimension][0]+" :: "+ad.sizeMapping[dimension][1],classFunc);sizeMapping.addSize(ad.sizeMapping[dimension][0],ad.sizeMapping[dimension][1]);});if(sizeMapping)IOL.adv.manager.slotsContainer[id].defineSizeMapping(sizeMapping.build());}if(ad.forceSafeFrame)IOL.adv.manager.slotsContainer[id].setForceSafeFrame(true);}if(ad.fnAfter){IOL.adv.tools.logger(ad.divId+" run fnAfter",classFunc);eval(ad.fnAfter);}}else{IOL.adv.tools.logger(ad.divId+" is not ready",classFunc);if(ad.sizeIsCompliant){if(ad.mediaType=='display')if(ad.optional!==true&&ad.divId!==''){IOL.adv.tools.logger(ad.divId+" is not ready",classFunc,"error");IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::"+ad.divId+"::divIdDoesNotExist";if(IOL.adv.track.enable)IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=error&msg="+IOL.adv.track.msg);}}else{IOL.adv.tools.logger(ad.divId+" is not in a valid range size",classFunc);}}});if(IOL.adv.pubAdsCfg.gptlazy){IOL.adv.tools.logger("Run googletag.enableLazyLoad",classFunc);googletag.pubads().enableLazyLoad({fetchMarginPercent:-1,renderMarginPercent:200,mobileScaling:2.0});}IOL.adv.tools.logger("Run setCustomCriteria",classFunc);IOL.adv.manager.setCustomCriteria(googletag);if(companionVideo){IOL.adv.tools.logger("companionVideo, run enableVideoAds",classFunc);googletag.companionAds().setRefreshUnfilledSlots(false);googletag.pubads().enableVideoAds();}IOL.adv.tools.logger("Run googletag.enableServices",classFunc);googletag.enableServices();if(IOL.adv.headerBidding.enable){IOL.adv.tools.logger("Call function prebid.run",classFunc);IOL.adv.headerBidding.run();}else{if(IOL.adv.pubAdsCfg.lazy){IOL.adv.tools.logger("Start Lazy loading in standard mode",classFunc);Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(id){var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];if(ad.lazy==false){IOL.adv.tools.logger(ad.divId+", lazy disable for this ads, start display",classFunc);IOL.adv.tools.displayAds({slotId:id,mode:"refresh-single",changeCorrelator:false});}else{IOL.adv.tools.logger(ad.divId+", lazy enabled for this ads, start intersectionObserver",classFunc);var d=IOL.adv.tools.divIdReady(ad,true);if(d){IOL.adv.settings.lazy.observer.obj.observe(d);IOL.adv.settings.lazy.divIdSlotIdMap[ad.divId]=id;}}});}else{IOL.adv.tools.logger("Ads start displayAds in standard mode for slot: "+IOL.adv.pubAdsCfg.slot,classFunc);if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop)IOL.adv.tools.trkPerf("iamRenderingStartMpuTop",Math.floor(performance.now()));IOL.adv.tools.displayAds({mode:"display-slots"});}try{if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete. HeaderBidding is disable",classFunc);IamCallbackOnComplete();}}catch(e){}}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally){IOL.adv.tools.logger("Run fnFinally on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally);}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer)if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally){IOL.adv.tools.logger("Run fnFinally on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally);}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop){googletag.pubads().addEventListener('slotRequested',function(event){try{var slot=event.slot;if(slot.getSlotElementId()===IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop.divId){IOL.adv.tools.logger('slotRequested for slot: '+slot.getSlotElementId(),classFunc);IOL.adv.tools.trkPerf("iamSlotRequestedMpuTop",Math.floor(performance.now()));}}catch(e){}});}googletag.pubads().addEventListener('slotRequested',function(event){try{var slot=event.slot;var sso=(IOL.adv.profile.up.value.gender||IOL.adv.profile.up.value.age)?'true':'false';IOL.adv.tools.logger('slotRequested for slot: '+slot.getSlotElementId()+', with sso: '+sso,classFunc);IOL.adv.tools.trkPerf("iamSSO"+sso,Math.floor(performance.now()));}catch(e){}});if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop){googletag.pubads().addEventListener('slotOnload',function(event){try{var slot=event.slot;if(slot.getSlotElementId()===IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop.divId){IOL.adv.tools.logger('slotOnload for slot: '+slot.getSlotElementId(),classFunc);IOL.adv.tools.trkPerf("iamSlotOnLoadMpuTop",Math.floor(performance.now()));}}catch(e){}});}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop){googletag.pubads().addEventListener('slotResponseReceived',function(event){try{var slot=event.slot;if(slot.getSlotElementId()===IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop.divId){IOL.adv.tools.logger('slotOnload for slot: '+slot.getSlotElementId(),classFunc);IOL.adv.tools.trkPerf("iamSlotResponseReceivedMpuTop",Math.floor(performance.now()));}}catch(e){}});}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop){googletag.pubads().addEventListener('slotRenderEnded',function(event){try{var slot=event.slot;if(slot.getSlotElementId()===IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop.divId){IOL.adv.tools.logger('slotRenderEnded for slot: '+slot.getSlotElementId(),classFunc);IOL.adv.tools.trkPerf("iamSlotRenderEndedMpuTop",Math.floor(performance.now()));}}catch(e){}});}googletag.pubads().addEventListener('slotRenderEnded',function(event){try{var trackMaxCPM=true&&IOL.adv.headerBidding.prebidjs.enable;IOL.adv.tools.trkPerf("iamRenderingEnd",Math.floor(performance.now()));if(IOL.adv.track.enable){IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+".onSlotRenderEnded::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::ads::time.rendering::"+Math.floor(performance.now());IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=debug&msg="+IOL.adv.track.msg);IOL.adv.tools.logger(IOL.adv.track.msg,classFunc);if(trackMaxCPM){var cpms={};var bids=pbjs.getHighestCpmBids();for(var i=0;i<bids.length;i++){var cpm={};cpm[bids[i].cpm]={"id":bids[i].adUnitCode,"size":bids[i].size,"bidder":bids[i].bidder};cpms=IOL.adv.tools.extend(cpms,cpm)}var maxCpm=Math.max.apply(null,Object.keys(cpms));if(cpms[maxCpm]){IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+"::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::"+cpms[maxCpm].id+"."+cpms[maxCpm].size+"::hb.cpm."+cpms[maxCpm].bidder+"::"+maxCpm;IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=debug&msg="+IOL.adv.track.msg);IOL.adv.tools.logger(IOL.adv.track.msg,classFunc);}trackMaxCPM=false;}var e=window.performance.getEntries();for(var i in e){if(e[i].name.indexOf('securepubads.g.doubleclick.net/gampad')!=-1){var d=Math.floor(e[i].startTime);IOL.adv.track.msg=IOL.adv.version+"::"+classFunc+".onGampadStartTime::"+IOL.adv.settings.ns+"::"+IOL.adv.pubAdsCfg.slot+"::::time.gampad.startTime::"+d;IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.track.remoteHandler,"rf="+IOL.adv.url+"&d="+IOL.adv.domain+"&lv=debug&msg="+IOL.adv.track.msg);IOL.adv.tools.logger(IOL.adv.track.msg,classFunc);IOL.adv.tools.trkPerf("iamGampad",Math.floor(performance.now()));}}IOL.adv.track.enable=false;}if(typeof IamCallbackSlotRenderEnded==="function"){IOL.adv.tools.logger("Hook IamCallbackSlotRenderEnded for "+event.slot.getSlotElementId(),classFunc);IamCallbackSlotRenderEnded();}}catch(e){}});if(IOL.adv.debug.console)IOL.adv.showConsole();IOL.adv.tools.logger("End function. ",classFunc);});},runVideoOnly:function(){var classFunc=IOL.adv.manager.classname+".runVideoOnly";IOL.adv.tools.logger("Start function. ",classFunc);if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit){IOL.adv.tools.logger("Run fnInit on slot: "+IOL.adv.pubAdsCfg.slot,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit);}Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(id){IOL.adv.tools.logger("Start manage ads "+id,classFunc);var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];if(ad.fnBefore){IOL.adv.tools.logger(id+" run fnBefore",classFunc);eval(ad.fnBefore);}if(ad.fnAfter){IOL.adv.tools.logger(ad.divId+" run fnAfter",classFunc);eval(ad.fnAfter);}});if(IOL.adv.headerBidding.enable){IOL.adv.tools.logger("Call function prebid.run",classFunc);IOL.adv.headerBidding.run();}if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally){IOL.adv.tools.logger("Run fnFinally on slot: "+IOL.adv.pubAdsCfg.slot,classFunc);eval(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally);}if(!IOL.adv.headerBidding.enable){try{if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete in sendAdserverRequest",classFunc);IamCallbackOnComplete();}}catch(e){}}if(IOL.adv.debug.console)IOL.adv.showConsole();IOL.adv.complete=true;IOL.adv.tools.logger("IAM complete, only video",classFunc);IOL.adv.tools.logger("End function. ",classFunc);},setCustomCriteria:function(googletag){var classFunc=IOL.adv.manager.classname+".setCustomCriteria";IOL.adv.tools.timer(classFunc,"Function","start");IOL.adv.tools.logger("Start function",classFunc);var consentString=IOL.adv.getConsentString();IOL.adv.pubAdsCfg.native=(window.pubAdsCfg.native)?window.pubAdsCfg.native:((IOL.adv.debug.native)?IOL.adv.debug.native:false);IOL.adv.pubAdsCfg.inread=(window.pubAdsCfg.inread)?window.pubAdsCfg.inread:((IOL.adv.debug.inread)?IOL.adv.debug.inread:false);var customCriteriaMap={"oe":{condition:typeof document.characterSet==='string',value:document.characterSet,otherwise:"UTF-8"},"optout":{condition:IOL.adv.profile.enable,value:"0",otherwise:"1"},"adv_infocus":{condition:IOL.adv.hasFocus,value:"yes",otherwise:"no"},"adv_np":{condition:IOL.adv.cookie.get('ADV_NP'),value:"yes"},"gdpr":{condition:consentString!='',value:"1"},"gdpr_consent":{condition:consentString!='',value:consentString},"adv_topics":{condition:IOL.adv.topics.length>0,value:IOL.adv.topics},"adv_referrer":{condition:true,value:IOL.adv.referrerLabel},"native":{condition:IOL.adv.pubAdsCfg.native!==false,value:IOL.adv.pubAdsCfg.native},"lotid":{condition:IOL.adv.profile.enable&&IOL.adv.profile.as.value.pid!='',value:IOL.adv.profile.as.value.pid},"laud":{condition:IOL.adv.profile.enable&&IOL.adv.profile.as.value.audienceId.length>0,value:IOL.adv.profile.as.value.audienceId},"1plusx":{condition:IOL.adv.profile.enable&&IOL.adv.profile.as.value.s.length>0,value:IOL.adv.profile.as.value.s},"ctx1plusx":{condition:IOL.adv.profile.enable&&IOL.adv.profile.as.value.t.length>0,value:IOL.adv.profile.as.value.t},"xdid_user":{condition:IOL.adv.profile.up.value.ppid.iol,value:"true"},"xdid_user_ui":{condition:((IOL.adv.profile.up.value.ui)==1),value:"true",otherwise:"false"},"adv_sso1":{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.age,value:IOL.adv.profile.up.value.age,otherwise:"0"},"adv_sso2":{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.gender,value:IOL.adv.profile.up.value.gender,otherwise:"0"},"adv_sso3":{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.province,value:IOL.adv.profile.up.value.province,otherwise:"0"},"seat_keyword":{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.ext.seat_keyword,value:IOL.adv.profile.up.value.ext.seat_keyword}};if(IOL.adv.pubAdsCfg.customCriteria){Object.keys(IOL.adv.pubAdsCfg.customCriteria).forEach(function(k){IOL.adv.tools.logger("Manage client customCriteria: "+k+" value:"+IOL.adv.pubAdsCfg.customCriteria[k],classFunc);if(IOL.adv.pubAdsCfg.customCriteria[k]!==''){customCriteriaMap[k]={condition:false,value:false};customCriteriaMap[k].condition=true;customCriteriaMap[k].value=String(IOL.adv.pubAdsCfg.customCriteria[k]).replace(/\|/g,",");}});}IOL.adv.manager.customCriteria.map=IOL.adv.tools.extend(IOL.adv.manager.customCriteria.map,customCriteriaMap);Object.keys(IOL.adv.manager.customCriteria.map).forEach(function(t){IOL.adv.tools.logger("Manage Target: "+t+" :: condition: "+IOL.adv.manager.customCriteria.map[t].condition+" :: value: "+IOL.adv.manager.customCriteria.map[t].value+" :: otherwise: "+IOL.adv.manager.customCriteria.map[t].otherwise,classFunc);if(IOL.adv.manager.customCriteria.map[t].condition&&IOL.adv.manager.customCriteria.map[t].value!==undefined){var v=String(IOL.adv.manager.customCriteria.map[t].value);IOL.adv.manager.customCriteria.set[t]=v;IOL.adv.tools.logger("Condition is true for Target: "+t+" :: assign value: "+v,classFunc);googletag.pubads().setTargeting(t,v);}else if(IOL.adv.manager.customCriteria.map[t].otherwise){googletag.pubads().setTargeting(t,IOL.adv.manager.customCriteria.map[t].otherwise);IOL.adv.manager.customCriteria.set[t]=IOL.adv.manager.customCriteria.map[t].otherwise;IOL.adv.tools.logger("Condition is false, otherwise is configured for Target: "+t+" :: assign value: "+IOL.adv.manager.customCriteria.map[t].otherwise,classFunc);}else
IOL.adv.tools.logger("Condition is false, otherwise is not configured for Target: "+t+", custom criteria has not been set",classFunc);});IOL.adv.manager.customCriteria.duration=IOL.adv.tools.timer(classFunc,"Function","partial");IOL.adv.tools.logger("End function, Time elapsed is:  "+IOL.adv.tools.timer(classFunc,"Function","partial"),classFunc);},createAds:function(id,idx){var classFunc=IOL.adv.manager.classname+".createAds";IOL.adv.tools.logger("Start function",classFunc);var idx=(idx)?idx:0;var adsLimit=10;try{if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic.enable||!id||(idx+1)>adsLimit)return;IOL.adv.mode="dynamic";IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id]={};IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].divId=id;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].adUnitPath=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic.adUnitPath+"/"+(idx+1);IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].size=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic.size;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].bidAmazon=true;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].divIdReady=true;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].mediaType='display';IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].sizeIsCompliant=true;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].forceSafeFrame=false;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].fnBefore=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic.fnBefore;IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].fnAfter=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic.fnAfter;IOL.adv.tools.logger("Create dynamic ads with id: "+id+", idx: "+idx,classFunc);if(IOL.adv.headerBidding.enable&&IOL.adv.settings.prebidjs.dynamicAdUnits){if(IOL.adv.settings.prebidjs.dynamicAdUnits[idx]){IOL.adv.settings.prebidjs.dynamicAdUnits[idx].code=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id].divId;IOL.adv.settings.prebidjs.adUnits.push(Object.assign({},IOL.adv.settings.prebidjs.dynamicAdUnits[idx]));IOL.adv.tools.logger("Prebid adUnit code found for ads: "+id,classFunc);}else
IOL.adv.tools.logger("Prebid adUnit code not found for ads: "+id,classFunc);}else
IOL.adv.tools.logger("Prebid disabled for ads: "+id,classFunc);IOL.adv.tools.logger("End function",classFunc);}catch(e){}}}}if(!window.iamInitialized){IOL.adv.headerBidding={classname:"IOL.adv.headerBidding",enable:true,hbTimeout:1600,bidderTimeout:1500,displayAfterSlotSwitch:false,bidders:[],requestManager:{adServerRequestSent:false,timer:false,timedOut:false},amazon:{id:'amazon',enable:false,init:false,pubID:'3204',adServer:'googletag',deals:true,slotsDisplay:[],slotsVideo:[],slots:[],excludeSizes:[[1,1],[320,100],[336,250],[336,280],[728,1],[970,270]],videoAdServer:'DFP',videoBid:''},prebidjs:{id:'prebidjs',enable:false,adUnits:[],customConfigObject:{"buckets":[{"precision":2,"max":3,"increment":0.01},{"precision":2,"max":8,"increment":0.05},{"precision":2,"max":20,"increment":0.5},{"precision":2,"max":30,"increment":1}]},customSizeConfig:[{'mediaQuery':'(min-width: 1025px)','sizesSupported':[[1800,1000],[1200,90],[970,250],[970,90],[728,90],[640,480],[300,250],[300,600],[100,200],[1,1]],'labels':['desktop']},{'mediaQuery':'(min-width: 766px) and (max-width: 1024px)','sizesSupported':[[728,90],[640,480],[300,250],[300,600],[100,200],[1,1]],'labels':['tablet']},{'mediaQuery':'(min-width: 320px) and (max-width: 765px)','sizesSupported':[[640,480],[300,250],[300,600],[300,50],[320,50],[320,100],[100,200],[1,1]],'labels':['mobile']}]},owt:{enable:false,slots:[],notifyId:[]},init:function(ads,adUnits){var classFunc=IOL.adv.headerBidding.classname+".init";IOL.adv.tools.logger("Start function",classFunc);IOL.adv.headerBidding.enable=false;IOL.adv.headerBidding.amazon.enable=false;IOL.adv.headerBidding.amazon.slots=[];IOL.adv.headerBidding.amazon.slotsVideo=[];IOL.adv.headerBidding.amazon.slotsDisplay=[];IOL.adv.headerBidding.amazon.videoBid='';IOL.adv.headerBidding.prebidjs.enable=false;IOL.adv.headerBidding.bidders=[];IOL.adv.headerBidding.requestManager={};IOL.adv.headerBidding.requestManager.adServerRequestSent=false;IOL.adv.headerBidding.requestManager.timedOut=false;if(IOL.adv.tools.mEnable("owt"))IOL.adv.headerBidding.owt.enable=typeof(OWT)!="undefined";if(!IOL.adv.pubAdsCfg.prebid){IOL.adv.tools.logger("HeaderBidding is disabled by the client.",classFunc);return;}switch(IOL.adv.connectionType){case"3g":IOL.adv.headerBidding.hbTimeout=2500;IOL.adv.headerBidding.bidderTimeout=2490;break;case"2g":IOL.adv.headerBidding.hbTimeout=6100;IOL.adv.headerBidding.bidderTimeout=6000;break;default:break;}IOL.adv.tools.logger("Set hbTimeout:"+IOL.adv.headerBidding.hbTimeout+", bidderTimeout:"+IOL.adv.headerBidding.bidderTimeout,classFunc);if(!adUnits)adUnits=[];Object.keys(ads).forEach(function(key){var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[key];if(ad.mediaType=='video')IOL.adv.manager.videoAds=true;});if(Object.keys(ads).length==1&&IOL.adv.manager.videoAds){IOL.adv.manager.videoOnly=true;IOL.adv.tools.logger("This slot contains a single ads with mediaType video",classFunc);}IOL.adv.tools.logger("HeaderBidding, start compliance check for Amazon.",classFunc);if(typeof apstag!=='undefined'){Object.keys(ads).forEach(function(key){var ad=ads[key];var sizes=[];if(ad.size)sizes=ad.size.filter(IOL.adv.tools.filterArrayInArray,{'list':IOL.adv.headerBidding.amazon.excludeSizes});IOL.adv.tools.logger("HeaderBidding Amazon for "+key+" ::"+" ad.sizeIsCompliant:"+ad.sizeIsCompliant+" ad.mediaType:"+ad.mediaType+" ad.divIdReady:"+ad.divIdReady+" ad.bidAmazon:"+ad.bidAmazon+" sizes:"+sizes,classFunc);if(ad.bidAmazon&&ad.sizeIsCompliant&&ad.divIdReady&&sizes.length>0){IOL.adv.tools.logger("HeaderBidding Amazon enable for "+key,classFunc);if(ad.mediaType=="display"){if(IOL.adv.headerBidding.owt.enable)IOL.adv.headerBidding.owt.slots.push(ad.divId);IOL.adv.headerBidding.amazon.slotsDisplay.push({slotID:ad.divId,slotName:ad.adUnitPath,sizes:sizes});}if(ad.mediaType=="video"){IOL.adv.headerBidding.amazon.slotsVideo.push({slotID:'videoSlot',mediaType:'video'});}}});IOL.adv.headerBidding.amazon.slots=IOL.adv.headerBidding.amazon.slotsDisplay.concat(IOL.adv.headerBidding.amazon.slotsVideo);if(IOL.adv.headerBidding.amazon.slots.length>0){IOL.adv.headerBidding.amazon.enable=true;IOL.adv.headerBidding.bidders.push(IOL.adv.headerBidding.amazon.id);if(IOL.adv.headerBidding.owt.enable&&IOL.adv.headerBidding.owt.slots.length>0)IOL.adv.headerBidding.owt.notifyId=window.OWT.registerExternalBidders(IOL.adv.headerBidding.owt.slots);if(!IOL.adv.headerBidding.amazon.init){apstag.init({pubID:IOL.adv.headerBidding.amazon.pubID,adServer:IOL.adv.headerBidding.amazon.adServer,videoAdServer:IOL.adv.headerBidding.amazon.videoAdServer,deals:IOL.adv.headerBidding.amazon.deals,gdpr:{enabled:IOL.adv.gdpr.enable,consent:IOL.adv.gdpr.consentString}});IOL.adv.headerBidding.amazon.init=true;}IOL.adv.tools.logger("HeaderBidding amazon compliant and initialized.",classFunc);}}else
IOL.adv.tools.logger("HeaderBidding amazon: apstag is not defined",classFunc);IOL.adv.tools.logger("HeaderBidding amazon enable: "+IOL.adv.headerBidding.amazon.enable,classFunc);IOL.adv.tools.logger("HeaderBidding, start compliance check for prebidjs.",classFunc);if(typeof pbjs!=='undefined'&&adUnits.length>0){IOL.adv.headerBidding.prebidjs.enable=true;IOL.adv.headerBidding.bidders.push(IOL.adv.headerBidding.prebidjs.id);pbjs.removeAdUnit();var keyValues={adv_sso1:[(IOL.adv.profile.enable?(IOL.adv.profile.up.value.age?IOL.adv.profile.up.value.age:"0"):"0")],adv_sso2:[(IOL.adv.profile.enable?(IOL.adv.profile.up.value.gender?IOL.adv.profile.up.value.gender:"0"):"0")]};adUnits.forEach(function(adUnit){adUnit.bids.find(IOL.adv.headerBidding.addKeyValueByCode,{bidder:'improvedigital',keyValues:keyValues});});pbjs.bidderSettings={adform:{bidCpmAdjustment:function(bidCpm){return bidCpm*0.88;}},ias:{alwaysUseBid:true,sendStandardTargeting:false,suppressEmptyKeys:true,adserverTargeting:[{key:'adt',val:function(bidResponse){return bidResponse.adt;}},{key:'alc',val:function(bidResponse){return bidResponse.alc;}},{key:'dlm',val:function(bidResponse){return bidResponse.dlm;}},{key:'drg',val:function(bidResponse){return bidResponse.drg;}},{key:'hat',val:function(bidResponse){return bidResponse.hat;}},{key:'off',val:function(bidResponse){return bidResponse.off;}},{key:'vio',val:function(bidResponse){return bidResponse.vio;}},{key:'fr',val:function(bidResponse){return bidResponse.fr;}},{key:'id',val:function(bidResponse){var match=bidResponse.slots[bidResponse.adUnitCode];return match.id;}},{key:'vw',val:function(bidResponse){var match=bidResponse.slots[bidResponse.adUnitCode];return match.vw;}},{key:'grm',val:function(bidResponse){var match=bidResponse.slots[bidResponse.adUnitCode];return match.grm;}},{key:'pub',val:function(bidResponse){var match=bidResponse.slots[bidResponse.adUnitCode];return match.pub;}},]}};pbjs.que.push(function(){IOL.adv.tools.logger("HeaderBidding prebidjs, Start pbjs.que.push",classFunc);var gdpr={};if(IOL.adv.gdpr.enable){IOL.adv.tools.logger("apply GDPR TCF v2.0",classFunc);gdpr={gdpr:{cmpApi:'iab',timeout:1400,defaultGdprScope:true}};if(IOL.adv.gdpr.tcfv20.pipeline.cmpApi=='static'){IOL.adv.tools.logger("method is static, consentData: "+IOL.adv.gdpr.consentString,classFunc);gdpr={gdpr:{cmpApi:'static',consentData:{getTCData:{tcString:IOL.adv.gdpr.consentString,gdprApplies:true}}}};}}var pd="";pbjs.setConfig({enableSendAllBids:true,priceGranularity:IOL.adv.headerBidding.prebidjs.customConfigObject,currency:{"adServerCurrency":"USD"},sizeConfig:IOL.adv.headerBidding.prebidjs.customSizeConfig,userSync:{iframeEnabled:true,userIds:[{name:'id5Id',params:{partner:522,pd:pd,abTesting:{enabled:false,controlGroupPct:0.1}},storage:{type:'html5',name:'id5id',expires:90,refreshInSeconds:8*3600}},{name:'identityLink',params:{pid:'1274'},storage:{type:'cookie',name:'idl_env',expires:1}},{name:"lotamePanoramaId",}]},bidderTimeout:IOL.adv.headerBidding.bidderTimeout,rubicon:{singleRequest:true},improvedigital:{usePrebidSizes:true,singleRequest:true},consentManagement:gdpr});if(IOL.adv.manager.videoAds)pbjs.setConfig({cache:{url:'https://prebid.adnxs.com/pbc/v1/cache'}});pbjs.aliasBidder('smartadserver','smart');pbjs.addAdUnits(adUnits);IOL.adv.tools.logger("HeaderBidding prebidjs compliant and initialized.",classFunc);});}else
IOL.adv.tools.logger("HeaderBidding prebidjs: pbjs is not defined or adUnits is empty",classFunc);IOL.adv.tools.logger("HeaderBidding prebidjs enable: "+IOL.adv.headerBidding.prebidjs.enable,classFunc);IOL.adv.headerBidding.bidders.forEach(function(bidder){IOL.adv.headerBidding.requestManager[bidder]=false;});if(IOL.adv.headerBidding.bidders.length>0){IOL.adv.settings.disableInitialLoad=true;IOL.adv.headerBidding.enable=true;}else{IOL.adv.headerBidding.enable=false;IOL.adv.settings.disableInitialLoad=false;}IOL.adv.tools.logger("HeaderBidding enable: "+IOL.adv.headerBidding.enable,classFunc);IOL.adv.tools.logger("End function",classFunc);},run:function(callback){var classFunc=IOL.adv.headerBidding.classname+".run";IOL.adv.tools.logger("Start function",classFunc);IOL.adv.tools.trkPerf("iamHBStart",Math.floor(performance.now()));if(IOL.adv.headerBidding.amazon.enable){IOL.adv.tools.logger("Start fetch bids for amazon.",classFunc);apstag.fetchBids({slots:IOL.adv.headerBidding.amazon.slots,timeout:IOL.adv.headerBidding.bidderTimeout},function(bids){IOL.adv.tools.logger("HeaderBidding amazon response: "+JSON.stringify(bids),classFunc);var videoBids=bids.filter(function(bid){return bid.mediaType==='video';});if(videoBids.length>0){videoBids.forEach(function(videoBid){IOL.adv.headerBidding.setAmazonVideoBid(videoBid.helpers.encodedQsParams());})}if(!IOL.adv.manager.videoOnly){googletag.cmd.push(function(){apstag.setDisplayBids();});}if(IOL.adv.headerBidding.owt.enable)googletag.cmd.push(function(){window.OWT.notifyExternalBiddingComplete(IOL.adv.headerBidding.owt.notifyId);});IOL.adv.headerBidding.headerBidderBack(IOL.adv.headerBidding.amazon.id,callback);});}else
IOL.adv.tools.logger("HeaderBidding amazon is disable.",classFunc);if(IOL.adv.headerBidding.prebidjs.enable){IOL.adv.tools.logger("Start fetch bids for prebid.",classFunc);Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(id){var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];if(!ad.divIdReady){pbjs.adUnits=pbjs.adUnits.filter(IOL.adv.headerBidding.filterAdunitByCode,{code:ad.divId});}});pbjs.requestBids({timeout:IOL.adv.headerBidding.bidderTimeout,bidsBackHandler:function(bidResponses){IOL.adv.tools.logger("HeaderBidding pbjs response: "+JSON.stringify(bidResponses),classFunc);IOL.adv.headerBidding.headerBidderBack(IOL.adv.headerBidding.prebidjs.id,callback);}});IOL.adv.tools.logger("HeaderBidding prebidjs, End pbjs.que.push",classFunc);}else
IOL.adv.tools.logger("HeaderBidding prebidjs is disable.",classFunc);if(IOL.adv.headerBidding.enable){IOL.adv.headerBidding.requestManager.timer=window.setTimeout(function(){IOL.adv.headerBidding.sendAdserverRequest(function(){IOL.adv.headerBidding.adServerRequestTimedOut(callback)});},IOL.adv.headerBidding.hbTimeout);}IOL.adv.tools.logger("End function",classFunc);},adServerRequestTimedOut:function(callback){var classFunc=IOL.adv.headerBidding.classname+".adServerRequestTimedOut";if(IOL.adv.headerBidding.requestManager.timer!==false){IOL.adv.headerBidding.requestManager.timedOut=true;IOL.adv.tools.trkPerf("iamHBtimeout",Math.floor(performance.now()));}IOL.adv.tools.logger("requestManager.timedOut: "+IOL.adv.headerBidding.requestManager.timedOut,classFunc);try{if(callback){IOL.adv.tools.logger("Run callback in adServerRequestTimedOut "+callback,classFunc);callback();}if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete",classFunc);IamCallbackOnComplete();}}catch(e){}},sendAdserverRequest:function(callback){var classFunc=IOL.adv.headerBidding.classname+".sendAdserverRequest";IOL.adv.tools.logger("Start function",classFunc);if(IOL.adv.headerBidding.requestManager.adServerRequestSent===true){IOL.adv.tools.logger("Request has been already sent, elapsed: "+IOL.adv.tools.timer("IOL.adv",".grandTotal","elapsed")+", adServerRequestSent: "+IOL.adv.headerBidding.requestManager.adServerRequestSent,classFunc);return;}IOL.adv.headerBidding.requestManager.adServerRequestSent=true;clearTimeout(IOL.adv.headerBidding.requestManager.timer);IOL.adv.tools.trkPerf("iamHBend",Math.floor(performance.now()));IOL.adv.tools.logger("Request has not been sent, start adServerRequest push",classFunc);if(IOL.adv.manager.videoOnly){IOL.adv.tools.logger("HeaderBidding in videoOnly mode, skip the display strategy, callback: "+callback,classFunc);try{if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete in sendAdserverRequest",classFunc);IamCallbackOnComplete();}}catch(e){}return;}var googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){clearTimeout(IOL.adv.headerBidding.requestManager.timer);if(IOL.adv.headerBidding.amazon.enable)apstag.setDisplayBids();if(IOL.adv.headerBidding.prebidjs.enable)pbjs.setTargetingForGPTAsync();switch(IOL.adv.mode){case'refresh':IOL.adv.tools.logger("Ads start displayAds after headerBidding in refreshMode",classFunc);IOL.adv.tools.displayAds({slotContainer:IOL.adv.manager.refreshSlotsContainer.slots,mode:"refresh-slots"});break;default:if(IOL.adv.pubAdsCfg.lazy){IOL.adv.tools.logger("Start Lazy loading after header bidding",classFunc);var unLazySlotsContainer=[];Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(id){var ad=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[id];if(ad.mediaType=='display'){if(ad.lazy){IOL.adv.tools.logger(ad.divId+", lazy enabled for this ads, start intersectionObserver",classFunc);var d=IOL.adv.tools.divIdReady(ad,true);if(d){IOL.adv.settings.lazy.observer.obj.observe(d);IOL.adv.settings.lazy.divIdSlotIdMap[ad.divId]=id;}}else{IOL.adv.tools.logger(ad.divId+", lazy disable for this ads, add to unLazySlotsContainer",classFunc);unLazySlotsContainer.push(IOL.adv.manager.slotsContainer[id]);}}});if(unLazySlotsContainer.length>0){IOL.adv.tools.logger("start display the unLazySlotsContainer",classFunc);IOL.adv.tools.displayAds({slotContainer:unLazySlotsContainer,mode:"refresh-slots"});if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop)IOL.adv.tools.trkPerf("iamRenderingStartMpuTop",Math.floor(performance.now()));}}else{if(IOL.adv.headerBidding.displayAfterSlotSwitch){IOL.adv.tools.logger("Ads start displayAds after headerBidding and slotSwitch",classFunc);IOL.adv.tools.displayAds({slotId:IOL.adv.manager.lastSlotIdReady,mode:"refresh-single"});}else{IOL.adv.tools.logger("Ads start displayAds after headerBidding",classFunc);if(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.admputop)IOL.adv.tools.trkPerf("iamRenderingStartMpuTop",Math.floor(performance.now()));IOL.adv.tools.displayAds({mode:"refresh-slots"});}}}window.aax=window.aax||{};window.aax.cmd=window.aax.cmd||[];window.aax.cmd.push(function(){if(window.aax.getAbpStatus()){window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];window.googletag.cmd.push(function(){googletag.pubads().refresh();});}});if(callback){IOL.adv.tools.logger("Run callback in googletag.cmd.push "+callback,classFunc);callback();}if(typeof IamCallbackOnComplete==="function"){IOL.adv.tools.logger("Hook IamCallbackOnComplete in sendAdserverRequest",classFunc);IamCallbackOnComplete();}});IOL.adv.tools.logger("End function",classFunc);},allBiddersBack:function(){var classFunc=IOL.adv.headerBidding.classname+".allBiddersBack";var allBiddersBack=IOL.adv.headerBidding.bidders.map(function(bidder){return IOL.adv.headerBidding.requestManager[bidder];}).filter(Boolean).length===IOL.adv.headerBidding.bidders.length;return allBiddersBack;},headerBidderBack:function(bidder,callback){var classFunc=IOL.adv.headerBidding.classname+".headerBidderBack";if(IOL.adv.headerBidding.requestManager.adServerRequestSent===true){return;}IOL.adv.headerBidding.requestManager[bidder]=true;IOL.adv.tools.logger("HeaderBidding requestManager: "+JSON.stringify(IOL.adv.headerBidding.requestManager),classFunc);if(IOL.adv.headerBidding.allBiddersBack()){IOL.adv.tools.logger("HeaderBidding allBiddersBack requestManager: "+JSON.stringify(IOL.adv.headerBidding.requestManager),classFunc);IOL.adv.headerBidding.sendAdserverRequest(callback);}},addKeyValueByCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".addKeyValueByCode";try{if(e.bidder===this.bidder){e.params.keyValues=this.keyValues;IOL.adv.tools.logger(this.bidder+" code found, add keyValues",classFunc);}else{IOL.adv.tools.logger(this.bidder+" code does not match "+e.bidder,classFunc);}}catch(err){return false;}},replaceAdunitByCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".replaceAdunitByCode";try{if(e.code===this.code){e.code=this.newcode;IOL.adv.tools.logger(this.code+" code found, replace prebid adUnit code",classFunc);}else{IOL.adv.tools.logger(this.code+" code does not match "+e.code,classFunc);}}catch(err){return false;}},cloneAdunitByCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".cloneAdunitByCode";try{if(e.code===this.code){var adUnit=Object.assign({},e);adUnit.code=this.newcode;IOL.adv.settings.prebidjs.adUnits.push(adUnit)
IOL.adv.tools.logger(this.code+" code found, prebid adUnit cloned",classFunc);}else{IOL.adv.tools.logger(this.code+" code does not match "+e.code,classFunc);}}catch(err){return false;}},setAdunitPathByBidderCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".setAdunitPathByBidderCode";try{IOL.adv.tools.logger("Managing code: "+e.code+", try to find bidder: "+this.bidder,classFunc);e.bids.forEach(function(v){IOL.adv.tools.logger("Compare bidder ["+v.bidder+"] with ["+this.bidder+"]",classFunc);if(v.bidder==this.bidder){v.params.adUnitPath=this.adUnitPath;IOL.adv.tools.logger(this.bidder+" bidder found, set "+v.params.adUnitPath+" as adUnitPath on "+this.code,classFunc);}else{IOL.adv.tools.logger(v.bidder+" bidder does not match "+this.bidder,classFunc);}},{bidder:this.bidder,adUnitPath:this.adUnitPath,code:e.code});}catch(err){return false;}},filterAdunitByCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".filterAdunitByCode";try{if(e.code===this.code){IOL.adv.tools.logger(this.code+" code found, remove item from prebid adUnit",classFunc);return false;}else{IOL.adv.tools.logger(this.code+" code does not match "+e.code,classFunc);return true;}}catch(err){return true;}},getAdunitByCode:function(e){var classFunc=IOL.adv.headerBidding.classname+".getAdunitByCode";try{if(e.code===this.code){IOL.adv.tools.logger(this.code+" code found, remove item from prebid adUnit",classFunc);return true;}else{IOL.adv.tools.logger(this.code+" code does not match "+e.code,classFunc);}}catch(err){return true;}},findAdunitByMediaType:function(e){var classFunc=IOL.adv.headerBidding.classname+".findAdunitByMediaType";try{if(e.mediaTypes[this.mediaType]){IOL.adv.tools.logger(this.mediaType+" adunit found",classFunc);return true;}else{IOL.adv.tools.logger(this.mediaType+" adunit not found",classFunc);return false;}}catch(err){return false;}},isEnable:function(){var classFunc=IOL.adv.headerBidding.classname+".isEnable";IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.enable,classFunc);return IOL.adv.headerBidding.enable;},isAmazonEnable:function(){var classFunc=IOL.adv.headerBidding.classname+".isAmazonEnable";IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.amazon.enable,classFunc);return IOL.adv.headerBidding.amazon.enable;},isPrebidJsEnable:function(){var classFunc=IOL.adv.headerBidding.classname+".isPrebidJsEnable";IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.prebidjs.enable,classFunc);return IOL.adv.headerBidding.prebidjs.enable;},getAmazonVideoBid:function(){var classFunc=IOL.adv.headerBidding.classname+".getAmazonVideoBid";IOL.adv.tools.logger("return videoBid:"+IOL.adv.headerBidding.amazon.videoBid,classFunc);return IOL.adv.headerBidding.amazon.videoBid;},setAmazonVideoBid:function(v){var classFunc=IOL.adv.headerBidding.classname+".setAmazonVideoBid";IOL.adv.headerBidding.amazon.videoBid+=v;IOL.adv.tools.logger("videoBid:"+IOL.adv.headerBidding.amazon.videoBid,classFunc);}}}if(typeof IOL.adv!='undefined'){try{if(!window.iamInitialized){window.iamInitialized=true;IOL.adv.tools.trkPerf("iamInjection",Math.floor(performance.now()));IOL.adv.debug.log=(IOL.adv.cookie.get('iamdbg')?true:false);if(IOL.adv.debug.log)IOL.adv.debug.id=IOL.adv.tools.randomId();if(IOL.adv.tools.mEnable("aax"))(function(){window.aax=window.aax||{};var aax=window.aax;aax.initTime=new Date().getTime();aax.pubId="AAXHTOHT6";aax.ver="1.2";aax.hst=window.location.hostname;var aaxEndpoint="https://c.aaxads.com/aax.js?pub="+aax.pubId+"&hst="+aax.hst+"&ver="+aax.ver;function loadScript(endpoint){var scriptTag=document.createElement("script"),placeTag=document.getElementsByTagName("script")[0];scriptTag.type="text/javascript";scriptTag.async=true;scriptTag.src=endpoint;placeTag.parentNode.insertBefore(scriptTag,placeTag);}loadScript(aaxEndpoint);})();if(IOL.adv.tools.mEnable("owt")||IOL.adv.tools.mEnable("pih2.0")){var iamRun=false;if(IOL.adv.tools.mEnable("owt")){IOL.adv.tools.logger("IAM run in OWT mode","IOL.adv.OWT");IOL.adv.settings.prebidjs={};if(IOL.adv.settings.library.prebid)IOL.adv.settings.library.prebid.enable=false;var PWT={};var pbjs=pbjs||{};pbjs.que=pbjs.que||[];var googletag=googletag||{};googletag.cmd=googletag.cmd||[];PWT.jsLoaded=function(){if(!iamRun){iamRun=true;IOL.adv.tools.logger("IAM start on PWT.jsLoaded","IOL.adv.OWT");IOL.adv.start();}else
IOL.adv.tools.logger("IAM has been already started","IOL.adv.OWT");};setTimeout(function(){if(!iamRun){iamRun=true;IOL.adv.tools.logger("IAM start on setTimeout","IOL.adv.OWT");IOL.adv.start();}else
IOL.adv.tools.logger("IAM has been already started","IOL.adv.OWT.setTimeout");},500);(function(){var purl=window.location.href;var pId=(IOL.adv.pageWidth>=1024)?"4249":"4541";var url='//ads.pubmatic.com/AdServer/js/pwt/83172/'+pId;var profileVersionId='';if(purl.indexOf('pwtv=')>0){var regexp=/pwtv=(.*?)(&|$)/g;var matches=regexp.exec(purl);if(matches.length>=2&&matches[1].length>0){profileVersionId='/'+matches[1];}}var wtads=document.createElement('script');wtads.async=true;wtads.type='text/javascript';wtads.src=url+profileVersionId+'/pwt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(wtads,node);})();}if(IOL.adv.tools.mEnable("pih2.0")){IOL.adv.tools.logger("IAM run in PWT mode","IOL.adv.PWT");var PWT={};var pbjs=pbjs||{};pbjs.que=pbjs.que||[];var googletag=googletag||{};googletag.cmd=googletag.cmd||[];PWT.jsLoaded=function(){if(!iamRun){iamRun=true;IOL.adv.tools.logger("IAM start on PWT.jsLoaded","IOL.adv.PWT");IOL.adv.start();}else
IOL.adv.tools.logger("IAM has been already started","IOL.adv.PWT");};setTimeout(function(){if(!iamRun){iamRun=true;IOL.adv.tools.logger("IAM start on setTimeout","IOL.adv.PWT");IOL.adv.start();}else
IOL.adv.tools.logger("IAM has been already started","IOL.adv.PWT.setTimeout");},150);(function(){var purl=window.location.href;var url='//ads.pubmatic.com/AdServer/js/pwt/83172/4188';var profileVersionId='';if(purl.indexOf('pwtv=')>0){var regexp=/pwtv=(.*?)(&|$)/g;var matches=regexp.exec(purl);if(matches.length>=2&&matches[1].length>0){profileVersionId='/'+matches[1];}}var wtads=document.createElement('script');wtads.async=true;wtads.type='text/javascript';wtads.src=url+profileVersionId+'/pwt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(wtads,node);})();}}else
IOL.adv.start();window.addEventListener('message',IOL.adv.tools.asHandler,false);window.addEventListener('beforeunload',function(event){IOL.adv.tools.trkPerf("iamPageUnloadAdvComplete"+((IOL.adv.complete)?'True':'False'),Math.floor(performance.now()));});}else
IOL.adv.tools.logger("IAM has been already initialized","IOL.adv");}catch(e){IOL.adv.tools.logger("Error "+e.message,"IOL.adv","error");}}